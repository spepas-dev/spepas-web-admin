import{e as n,A,r as g,j as e,v as h,a as S,c as x,U as E,m as I,d as b}from"./index-C2Q_LmeJ.js";import{B as M,a as G,P as C}from"./pageHeader-7vhK00zh.js";import{D}from"./index-CvxHYYsL.js";import{u as U}from"./modal-helpers-CaXMt30Z.js";import{C as F}from"./card-grid-CZ4tobzV.js";import{u as P,F as w,b as f,c as j,d as N,e as v,f as B}from"./form-CcMvRR1f.js";import{u as _}from"./useQuery-CUE0UVvY.js";import{s as $,z as l}from"./index-DyAPY9a1.js";import{u as K,G as T,M as R}from"./esm-TUw15Obf.js";import{I as L}from"./input-fvZZM-h7.js";import{M as H}from"./multi-select-GP_yjtwv.js";import{M as V}from"./map-pin-D3JmskLF.js";import{S as k}from"./shopping-bag-NHqPbCF3.js";import{P as q}from"./plus-BFloapdy.js";import{f as z}from"./format-CBpsKyOP.js";import"./table-CAIVgxvw.js";import"./dialog-BxdRvcNA.js";import"./select-K8uUziWX.js";import"./arrow-left-DT7SArHl.js";import"./arrow-right-Ct_-AZHB.js";import"./card-CVylEmF3.js";import"./popover-CI77UgAE.js";import"./globe-C44rbEdp.js";import"./utils-km2FGkQ4.js";import"./badge-rX3Jh1SJ.js";import"./separator-q4J_vRT3.js";import"./circle-x-DWBwq746.js";import"./wand-sparkles-JjYTZCVz.js";const c=A.USER_MANAGEMENT.BUYER;class J{static async registerBuyer(s){return n.post(`${c}`,s)}static async getBuyer(s){return n.get(`${c}/${s}`)}static async updateBuyer(s,a){return n.put(`${c}/${s}`,a)}static async deleteBuyer(s){return n.delete(`${c}/${s}`)}static async getBuyerStats(s){return n.get(`${c}/${s}/stats`)}static async getBuyerList(s){return n.get(`${c.BASE}`,{params:s})}}const u={all:["buyers"],list:()=>[...u.all,"list"],details:t=>[...u.all,"details",t],stats:t=>[...u.all,"stats",t]},O=()=>_({queryKey:u.list(),queryFn:()=>J.getBuyerList()}),Q=l.object({storeName:l.string().min(1,"Store name is required"),longitude:l.number(),latitude:l.number(),Gopa_ID:l.string().min(1,"Please select a Gopo"),User_ID:l.string().min(1,"Please select a user")}),Y=[{value:"528008c6-d9fd-4590-ad84-6b9a42b84197",label:"John Doe",icon:h},{value:"628008c6-d9fd-4590-ad84-6b9a42b84198",label:"Jane Smith",icon:h}],W=["places"];function X({onSubmit:t,loading:s=!1,selectedLocation:a}){const{isLoaded:m,loadError:p}=K({googleMapsApiKey:"",libraries:W}),d=g.useMemo(()=>({lat:5.6037,lng:-.187}),[]),o=P({resolver:$(Q),defaultValues:{storeName:"",longitude:(a==null?void 0:a.lng)||d.lng,latitude:(a==null?void 0:a.lat)||d.lat,Gopa_ID:"",User_ID:""}}),y=r=>{const i={storeName:r.storeName,Gopa_ID:r.Gopa_ID,Location:{type:"Point",coordinates:[r.longitude,r.latitude]},User_ID:r.User_ID};t(i),o.reset()};return p?e.jsx("div",{children:"Error loading map"}):m?e.jsx(w,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(y),className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"flex gap-4 items-start",children:e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsx(f,{control:o.control,name:"Gopa_ID",render:({field:r})=>e.jsxs(j,{children:[e.jsx(N,{className:"text-gray-700",children:"Select Gopo"}),e.jsx(v,{children:e.jsx(H,{options:Y,value:[r.value],onValueChange:i=>r.onChange(i[0]),placeholder:"Select a Gopo",maxCount:1,disabled:s})}),e.jsx(B,{className:"text-red-500"})]})}),e.jsx(f,{control:o.control,name:"storeName",render:({field:r})=>e.jsxs(j,{children:[e.jsx(N,{className:"text-gray-700",children:"Store Name"}),e.jsx(v,{children:e.jsx(L,{placeholder:"Enter store name",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",disabled:s,...r})}),e.jsx(B,{className:"text-red-500"})]})}),e.jsx("div",{className:"h-[200px] rounded-lg overflow-hidden",children:e.jsx(T,{zoom:13,center:d,mapContainerClassName:"w-full h-full",onClick:r=>{r.latLng&&(o.setValue("latitude",r.latLng.lat()),o.setValue("longitude",r.latLng.lng()))},children:e.jsx(R,{position:{lat:o.watch("latitude"),lng:o.watch("longitude")}})})})]})})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(S,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",disabled:s,children:s?"Saving...":"Save Buyer"})})]})}):e.jsx("div",{children:"Loading..."})}function Ie(){const{data:t,isLoading:s}=O(),a=g.useMemo(()=>(t==null?void 0:t.data)||[],[t==null?void 0:t.data]),m=U(),p=g.useMemo(()=>[{header:"Name",accessorKey:"name"},{header:"Email",accessorKey:"email"},{header:"Phone",accessorKey:"phoneNumber"},{header:"Status",accessorKey:"status",cell:({row:r})=>{const i=r.original.status===1;return e.jsxs("span",{className:x("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",i?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:[e.jsx("span",{className:x("w-1.5 h-1.5 rounded-full mr-1.5",i?"bg-green-400":"bg-red-400")}),i?"Active":"Inactive"]})}},{header:"Date Added",accessorKey:"createdAt",cell:({row:r})=>e.jsx("div",{children:z(r.original.createdAt,"dd/MM/yyyy HH:mm:ss a")})}],[]),d=()=>{m.openForm({title:"Add New Buyer",children:e.jsx(X,{onSubmit:o,loading:!1}),showFooter:!1})},o=async r=>{try{console.log(r),b.success("Buyer created successfully"),m.close()}catch{b.error("Failed to create buyer")}},y=[{title:"Total Buyers",value:a.length,Icon:h,description:"Registered buyers",trend:"+3.2%",trendUp:!0},{title:"Active Locations",value:a.length,Icon:V,description:"Service locations",trend:"+2.1%",trendUp:!0},{title:"Assigned Gopos",value:new Set(a.map(r=>r.Gopa_ID)).size,Icon:E,description:"Active Gopos",trend:"+1.5%",trendUp:!0},{title:"Total Products",value:156,Icon:k,description:"Listed products",trend:"+4.3%",trendUp:!0}];return e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsx(M,{items:G.threeTier("User Management","/user-management","Buyers")}),e.jsx(C,{title:"Buyers",description:"Manage buyers and their locations",actions:e.jsxs(S,{onClick:d,className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Add Buyer"]})}),e.jsx(F,{cards:y}),e.jsx(I.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:e.jsx(D,{data:a,columns:p,loading:s,tableStyle:"border rounded-lg bg-white",tableHeadClassName:"text-[#4A36EC] font-semibold"})})]})}export{Ie as default};
