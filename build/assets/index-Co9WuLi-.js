import{A as u,i as T,k as F,j as e,a as m,r as h,g as w,G as M,C as R,l as _,n as P,m as S,t as v}from"./index-Cx3yMQ3f.js";import{D as K}from"./index-D0svd0GM.js";import{C as U}from"./card-grid-C7Gl_Uh6.js";import{u as $,a as k,F as B,b as y,c as g,d as f,e as j,f as N}from"./form-DABIbnA-.js";import{u as O}from"./useMutation-DdnS_ohS.js";import{u as q}from"./useQuery-Ly3xzLnF.js";import{s as H,o as E,a as L,b}from"./index-CJEG_s-O.js";import{D as G,a as Q,b as z,c as V,d as W}from"./dialog-OWjewGbD.js";import{I as C}from"./input-BY_FTDhY.js";import{T as Y}from"./textarea-CLf_UvS5.js";import{T as J}from"./trash-2-78zht_3s.js";import{P as D}from"./plus-BarkCOgP.js";import{C as X}from"./clipboard-list-VDejjdrN.js";import{P as Z}from"./package-DLJer1pV.js";import{f as ee}from"./format-CBpsKyOP.js";import"./table-CbxoolaY.js";import"./sliders-horizontal-CPYaJ2M2.js";import"./x-45uRG9y6.js";import"./select-5_mZnO0V.js";import"./arrow-left-CEUZlc21.js";import"./arrow-right-DHaoxvRn.js";import"./card-BtOxIeoK.js";import"./popover-CAKtuJnK.js";import"./globe-CgBe-rT5.js";const A=T.INVENTORY_MANAGEMENT.CAR.SPARE_PART;class I{static async getSpareParts(a){return u.get(`${A.BASE}`,{params:a})}static async getSparePart(a){return u.get(`${A.DETAIL(a)}`)}static async createSparePart(a){return u.post(`${A.CREATE}`,a)}}const c={all:["spareparts"],detail:s=>[...c.all,"detail",s],lists:()=>[...c.all,"list"],list:s=>[...c.lists(),s],stats:()=>[...c.all,"stats"]},re=s=>q({queryKey:c.list({}),queryFn:()=>I.getSpareParts(s)}),ae=()=>{const s=F();return O({mutationFn:a=>I.createSparePart(a),onSuccess:()=>{s.invalidateQueries({queryKey:c.all})}})},se=E({name:b().min(1,"Part name is required"),description:b().min(10,"Description must be at least 10 characters"),carModel_ID:b()}),te=E({spareParts:L(se).min(1,"Add at least one spare part")});function ne({open:s,onOpenChange:a,onSubmit:n}){const t=$({resolver:H(te),defaultValues:{spareParts:[{name:"",description:"",carModel_ID:""}]}}),{fields:d,append:p,remove:i}=k({control:t.control,name:"spareParts"}),x=l=>{n(l.spareParts),t.reset()};return e.jsx(G,{open:s,onOpenChange:a,children:e.jsxs(Q,{className:"max-w-2xl bg-white",children:[e.jsxs(z,{children:[e.jsx(V,{className:"text-[#4A36EC] text-xl font-bold",children:"Add Spare Parts"}),e.jsx(W,{className:"text-gray-600",children:"Add one or more spare parts to the system"})]}),e.jsx(B,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(x),className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:d.map((l,o)=>e.jsxs("div",{className:"flex gap-4 items-start",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsx(y,{control:t.control,name:`spareParts.${o}.name`,render:({field:r})=>e.jsxs(g,{children:[e.jsx(f,{className:"text-gray-700",children:"Part Name"}),e.jsx(j,{children:e.jsx(C,{placeholder:"Enter part name",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",...r})}),e.jsx(N,{className:"text-red-500"})]})}),e.jsx(y,{control:t.control,name:`spareParts.${o}.description`,render:({field:r})=>e.jsxs(g,{children:[e.jsx(f,{className:"text-gray-700",children:"Description"}),e.jsx(j,{children:e.jsx(Y,{placeholder:"Enter part description",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",...r})}),e.jsx(N,{className:"text-red-500"})]})}),e.jsx(y,{control:t.control,name:`spareParts.${o}.carModel_ID`,render:({field:r})=>e.jsxs(g,{children:[e.jsx(f,{className:"text-gray-700",children:"Car Brand ID"}),e.jsx(j,{children:e.jsx(C,{placeholder:"Enter car brand ID",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",...r})}),e.jsx(N,{className:"text-red-500"})]})})]}),d.length>1&&e.jsx(m,{type:"button",variant:"outline",size:"icon",className:"mt-8 hover:bg-gray-100",onClick:()=>i(o),children:e.jsx(J,{className:"w-4 h-4 text-gray-600"})})]},l.id))}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(m,{type:"button",variant:"outline",className:"hover:bg-gray-100",onClick:()=>p({name:"",description:"",carModel_ID:""}),children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Add Another"]}),e.jsx(m,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:"Save Parts"})]})]})})]})})}function Te(){const[s,a]=h.useState(!1),{data:n,isLoading:t,isError:d}=re(),p=h.useMemo(()=>[{header:"Name of Part",accessorKey:"name"},{header:"Description",accessorKey:"description"},{header:"Status",accessorKey:"status",cell:({row:r})=>e.jsx("span",{className:w("text-sm font-medium py-1 px-2 rounded-md",`${r.original.status?"bg-green-100 text-green-900":"bg-red-100 text-red-900"}`),children:r.original.status?"Active":"Inactive"})},{header:"Price",accessorKey:"price",cell:({row:r})=>e.jsx("div",{children:new Intl.NumberFormat("en-US",{style:"currency",currency:"GHS"}).format(r.original.price)})},{header:"Created At",accessorKey:"createdAt",cell:({row:r})=>e.jsx("div",{children:ee(new Date(r.original.createdAt),"yyyy/MM/dd HH:mm:a")})}],[]),i=h.useMemo(()=>(n==null?void 0:n.data)||[],[n==null?void 0:n.data]),{mutate:x}=ae(),l=r=>{console.log(r),x(r,{onSuccess:()=>{a(!1),v.success("Spare part created successfully")},onError:()=>{a(!1),v.error("Failed to create spare part")}})},o=[{title:"Total Parts",value:i.length,Icon:M,description:"Active spare parts in system",trend:"+4.3%",trendUp:!0},{title:"Car Brands",value:new Set(i.map(r=>r.carModel_ID)).size,Icon:R,description:"Compatible car brands",trend:"+2.7%",trendUp:!0},{title:"Categories",value:12,Icon:X,description:"Part categories",trend:"+1.5%",trendUp:!0},{title:"In Stock",value:new Intl.NumberFormat("en-US").format(i.length),Icon:Z,description:"Available inventory",trend:"-0.8%",trendUp:!1}];return t?e.jsx("div",{className:"p-8 space-y-8",children:e.jsx(_,{})}):d?e.jsx("div",{children:"Error loading spare parts"}):e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx("a",{href:"/",className:"hover:text-[#4A36EC]",children:"Dashboard"}),e.jsx(P,{className:"w-4 h-4 mx-2"}),e.jsx("a",{href:"/inventory",className:"hover:text-[#4A36EC]",children:"Inventory"}),e.jsx(P,{className:"w-4 h-4 mx-2"}),e.jsx("span",{className:"text-[#4A36EC] font-medium",children:"Spare Parts"})]}),e.jsxs(S.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-[#4A36EC]",children:"Spare Parts"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage spare parts and their specifications"})]}),e.jsxs(m,{onClick:()=>a(!0),className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Add Spare Part"]})]}),e.jsx(U,{cards:o}),e.jsx(S.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:e.jsx(K,{columns:p,data:i,placeholder:"Search spare parts...",tableStyle:"border rounded-lg bg-white",tableHeadClassName:"text-[#4A36EC] font-semibold"})}),e.jsx(ne,{open:s,onOpenChange:a,onSubmit:l})]})}export{Te as default};
