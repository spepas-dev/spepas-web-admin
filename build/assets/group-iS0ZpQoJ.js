import{c as ue,r as j,g as O,j as e,F as H,i as Z,k as R,l as q,Q as W,R as D,n as Q,e as x,T as X,V as Y,X as J,Y as ee,Z as se,_ as te,$ as ae,p as u,a0 as ie,o as re,a1 as ge,G as N,U as V,S as je,s as fe,v as ye,w as be,m as I,b as U,a2 as _,a3 as G,a4 as T,q as Ne,C as ve,a5 as Ae,a6 as we,a7 as M,a8 as k,d as L,D as z,x as v}from"./index-BEfPUQd3.js";import{u as $}from"./modal-helpers-u5ghZSiS.js";import{b as Ce,c as Se,d as Ee}from"./group.mutations-D6XJwe7_.js";import{s as ne}from"./zod-DPUoip6C.js";import{z as y}from"./index-3Gi9B8Cu.js";import{C as le}from"./chevrons-up-down-BEyfiSas.js";import{B as w}from"./building-2-CTShFezU.js";import{u as Ie}from"./users.queries-BzwIn2G9.js";import{C as Ue}from"./circle-check-big-ByrHa0pu.js";import{P as A}from"./plus-D6nxsE-o.js";import"./dialog-DfEuW_jS.js";import"./useMutation-CxnX3va-.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=[["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}],["path",{d:"M10 4v4",key:"pp8u80"}],["path",{d:"M2 8h20",key:"d11cs7"}],["path",{d:"M6 4v4",key:"1svtjw"}]],Ge=ue("AppWindow",_e),Te=y.object({applicationIds:y.array(y.string()).min(1,"Please select at least one application")}),K=[{id:3,application_id:"app-3",name:"Order Management System",description:"Manage orders and customer requests",dateAdded:"2024-01-05T12:00:00Z",added_by:"System",status:1},{id:4,application_id:"app-4",name:"Payment Gateway",description:"Process payments and transactions",dateAdded:"2024-01-08T16:30:00Z",added_by:"System",status:1},{id:5,application_id:"app-5",name:"Analytics Dashboard",description:"View analytics and reports",dateAdded:"2024-01-12T09:15:00Z",added_by:"System",status:1},{id:6,application_id:"app-6",name:"Customer Support",description:"Handle customer support tickets",dateAdded:"2024-01-14T11:45:00Z",added_by:"System",status:0}];function Me({onSubmit:p,loading:h=!1,groupId:C}){const[g,f]=j.useState(!1),i=O({resolver:ne(Te),defaultValues:{applicationIds:[]}}),o=i.watch("applicationIds"),S=c=>{p({applicationIds:c.applicationIds}),i.reset()},m=c=>{const l=i.getValues("applicationIds");l.includes(c)?i.setValue("applicationIds",l.filter(t=>t!==c)):i.setValue("applicationIds",[...l,c])},r=K.filter(c=>o.includes(c.application_id));return e.jsx(H,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(S),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(Z,{control:i.control,name:"applicationIds",render:({field:c})=>e.jsxs(R,{className:"flex flex-col",children:[e.jsx(q,{className:"text-gray-700",children:"Select Applications"}),e.jsxs(W,{open:g,onOpenChange:f,children:[e.jsx(D,{asChild:!0,children:e.jsx(Q,{children:e.jsxs(x,{variant:"outline",role:"combobox","aria-expanded":g,className:"w-full justify-between border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",disabled:h,children:[r.length>0?e.jsxs("div",{className:"flex flex-wrap gap-1",children:[r.slice(0,2).map(l=>e.jsx("span",{className:"bg-[#4A36EC] text-white px-2 py-1 rounded text-xs",children:l.name},l.application_id)),r.length>2&&e.jsxs("span",{className:"bg-gray-200 text-gray-700 px-2 py-1 rounded text-xs",children:["+",r.length-2," more"]})]}):"Select applications...",e.jsx(le,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),e.jsx(X,{className:"w-full p-0",children:e.jsxs(Y,{children:[e.jsx(J,{placeholder:"Search applications..."}),e.jsxs(ee,{children:[e.jsx(se,{children:"No applications found."}),e.jsx(te,{children:K.map(l=>{const d=o.includes(l.application_id),t=l.status===1;return e.jsxs(ae,{value:l.name,onSelect:()=>m(l.application_id),className:"flex items-center gap-3 p-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-orange-400 to-orange-600 rounded-lg flex items-center justify-center",children:e.jsx(w,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:l.name}),e.jsx("p",{className:"text-xs text-gray-500",children:l.description}),e.jsx("p",{className:"text-xs text-gray-400",children:l.application_id})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:u("inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium",t?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:t?"Active":"Inactive"}),e.jsx(ie,{className:u("h-4 w-4",d?"opacity-100 text-[#4A36EC]":"opacity-0")})]})]},l.application_id)})})]})]})})]}),e.jsx(re,{className:"text-red-500"})]})}),r.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["Selected Applications (",r.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:r.map(c=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-orange-400 to-orange-600 rounded-lg flex items-center justify-center",children:e.jsx(w,{className:"w-3 h-3 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:c.name}),e.jsx("p",{className:"text-xs text-gray-500",children:c.application_id})]}),e.jsx(x,{type:"button",variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-red-600 hover:text-red-700",onClick:()=>m(c.application_id),children:"×"})]},c.application_id))})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(x,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",disabled:h||r.length===0,children:h?"Adding...":`Add ${r.length} Application${r.length!==1?"s":""}`})})]})})}const ke=y.object({userIds:y.array(y.string()).min(1,"Please select at least one user")});function Be({onSubmit:p,loading:h=!1,groupId:C}){const[g,f]=j.useState(!1),i=O({resolver:ne(ke),defaultValues:{userIds:[]}}),{data:o,isLoading:S}=Ie(),m=j.useMemo(()=>{var t;return((t=o==null?void 0:o.data)==null?void 0:t.map(a=>({id:a.User_ID,name:a.name,email:a.email,status:a.status,role:a.user_type})))||[]},[o==null?void 0:o.data]),r=i.watch("userIds"),c=t=>{p({userIds:t.userIds}),i.reset()},l=t=>{const a=i.getValues("userIds");a.includes(t)?i.setValue("userIds",a.filter(b=>b!==t)):i.setValue("userIds",[...a,t])},d=m.filter(t=>r.includes(t.id));return e.jsx(H,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(c),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(Z,{control:i.control,name:"userIds",render:({field:t})=>e.jsxs(R,{className:"flex flex-col",children:[e.jsx(q,{className:"text-gray-700",children:"Select Users"}),e.jsxs(W,{open:g,onOpenChange:f,children:[e.jsx(D,{asChild:!0,children:e.jsx(Q,{children:e.jsxs(x,{variant:"outline",role:"combobox","aria-expanded":g,className:"w-full justify-between border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",disabled:h,children:[d.length>0?e.jsxs("div",{className:"flex flex-wrap gap-1",children:[d.slice(0,2).map(a=>e.jsx("span",{className:"bg-[#4A36EC] text-white px-2 py-1 rounded text-xs",children:a.name},a.id)),d.length>2&&e.jsxs("span",{className:"bg-gray-200 text-gray-700 px-2 py-1 rounded text-xs",children:["+",d.length-2," more"]})]}):"Select users...",e.jsx(le,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),e.jsx(X,{className:"w-full p-0",children:e.jsxs(Y,{children:[e.jsx(J,{placeholder:"Search users..."}),e.jsxs(ee,{children:[e.jsx(se,{children:"No users found."}),e.jsx(te,{children:m.map(a=>{const E=r.includes(a.id);return e.jsxs(ae,{value:a.name,onSelect:()=>l(a.id),className:"flex items-center gap-3 p-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-[#4A36EC] to-[#5B4AEE] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-medium",children:a.name.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:a.name}),e.jsx("p",{className:"text-xs text-gray-500",children:a.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:u("inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium",a.status===1?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:a.status===1?"Active":"Inactive"}),e.jsx(ie,{className:u("h-4 w-4",E?"opacity-100 text-[#4A36EC]":"opacity-0")})]})]},a.id)})})]})]})})]}),e.jsx(re,{className:"text-red-500"})]})}),d.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["Selected Users (",d.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:d.map(t=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-[#4A36EC] to-[#5B4AEE] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-medium",children:t.name.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:t.name}),e.jsx("p",{className:"text-xs text-gray-500",children:t.role})]}),e.jsx(x,{type:"button",variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-red-600 hover:text-red-700",onClick:()=>l(t.id),children:"×"})]},t.id))})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(x,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",disabled:h||d.length===0,children:h?"Adding...":`Add ${d.length} User${d.length!==1?"s":""}`})})]})})}function We(){var P;const{groupId:p}=ge(),[h,C]=j.useState("overview");console.log("Group ID:",p);const g=$(),f=$(),{data:i,isLoading:o,isError:S}=Ce(p),m=j.useMemo(()=>{var s;return((s=i==null?void 0:i.data)==null?void 0:s.map(n=>({id:n.application_id,name:n.application.name,status:n.status===1?"active":"inactive",date_added:n.date_added,added_by:n.added_by})))||[]},[i==null?void 0:i.data]),{data:r,isLoading:c,isError:l}=Se(p),d=j.useMemo(()=>{var s;return((s=r==null?void 0:r.data)==null?void 0:s.user_groups.map(n=>n==null?void 0:n.user))||[]},[(P=r==null?void 0:r.data)==null?void 0:P.user_groups]),{title:t,date_added:a,added_by:E,status:b}=(r==null?void 0:r.data)||{},de=j.useMemo(()=>[{header:"User",accessorKey:"name",cell:({row:s})=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-[#4A36EC] to-[#5B4AEE] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-medium",children:s.original.name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.original.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.original.email})]})]})},{header:"User Type",accessorKey:"user_type",cell:({row:s})=>e.jsx(N,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:s.original.user_type})},{header:"Status",accessorKey:"status",cell:({row:s})=>{const n=s.original.status===1;return e.jsxs("span",{className:u("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",n?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:[e.jsx("span",{className:u("w-1.5 h-1.5 rounded-full mr-1.5",n?"bg-green-400":"bg-red-400")}),n?"Active":"Inactive"]})}},{header:"Verification Status",accessorKey:"verificationStatus",cell:({row:s})=>e.jsx("span",{className:u("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",s.original.verificationStatus===1?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:s.original.verificationStatus===1?"✓ Verified":"✗ Pending"})}],[]),ce=j.useMemo(()=>[{header:"Application",accessorKey:"name",cell:({row:s})=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-orange-400 to-orange-600 rounded-lg flex items-center justify-center",children:e.jsx(w,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.original.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.original.description})]})]})},{header:"Status",accessorKey:"status",cell:({row:s})=>{const n=s.original.status==="active";return e.jsxs("span",{className:u("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",n?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:[e.jsx("span",{className:u("w-1.5 h-1.5 rounded-full mr-1.5",n?"bg-green-400":"bg-red-400")}),n?"Active":"Inactive"]})}}],[]),B=()=>{g.openForm({title:"Add User to Group",size:"md",showFooter:!1,children:e.jsx(Be,{onSubmit:me,loading:!1,groupId:group.id})})},F=()=>{f.openForm({title:"Add Application to Group",size:"md",showFooter:!1,children:e.jsx(Me,{onSubmit:xe,loading:!1,groupId:group.id})})},{mutateAsync:oe}=Ee(),me=async s=>{try{console.log("Adding users to group:",s);const n=s.userIds.map(he=>({user_id:he,group_id:p}));console.log("payload",n),await oe(n),v.success("Users added to group successfully"),g.close()}catch{v.error("Failed to add users to group")}},xe=async s=>{try{console.log("Adding applications to group:",s),v.success("Applications added to group successfully"),f.close()}catch{v.error("Failed to add applications to group")}},pe=[{title:"Total Users",value:d.length,Icon:V,description:"Members in group",trend:"+2 this week",trendUp:!0},{title:"Applications",value:m.length,Icon:w,description:"Assigned apps",trend:"+1 this month",trendUp:!0},{title:"Active Users",value:d.filter(s=>s.status===1).length,Icon:Ue,description:"Currently active",trend:"100%",trendUp:!0},{title:"Permissions",value:15,Icon:je,description:"Total permissions",trend:"+3 new",trendUp:!0}];return e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsx(fe,{items:[...ye.threeTier("Access Management","/access-management","Groups"),{label:t,href:`/access-management/groups/${p}`}]}),e.jsx(be,{title:t,description:"Group Details & Management"}),e.jsx(I.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsx(U,{className:"border border-gray-200",children:e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-[#4A36EC] to-[#5B4AEE] rounded-lg flex items-center justify-center",children:e.jsx(V,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx(G,{className:"text-xl",children:t}),e.jsx(T,{children:a?Ne(new Date(a),"MMM dd, yyyy"):null})]})]}),e.jsx(N,{variant:b===1?"default":"secondary",className:"bg-green-100 text-green-800",children:b===1?"Active":"Inactive"})]})})})}),e.jsx(I.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:e.jsx(ve,{cards:pe})}),e.jsx(I.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:e.jsxs(Ae,{value:h,onValueChange:C,className:"space-y-6",children:[e.jsxs(we,{className:"grid w-full grid-cols-3",children:[e.jsx(M,{value:"overview",children:"Overview"}),e.jsxs(M,{value:"users",children:["Users (",d.length,")"]}),e.jsxs(M,{value:"applications",children:["Applications (",m.length,")"]})]}),e.jsx(k,{value:"overview",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(U,{children:[e.jsxs(_,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(G,{className:"text-lg",children:"Recent Users"}),e.jsx(T,{children:"Latest members added to this group"})]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:B,children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Add User"]})]}),e.jsx(L,{children:e.jsx("div",{className:"space-y-3",children:d.slice(0,3).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-[#4A36EC] to-[#5B4AEE] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-medium",children:s.name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.user_type})]})]}),e.jsx(N,{variant:"secondary",className:s.status===1?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:s.status===1?"Active":"Inactive"})]},s.id))})})]}),e.jsxs(U,{children:[e.jsxs(_,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(G,{className:"text-lg",children:"Applications"}),e.jsx(T,{children:"Apps assigned to this group"})]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:F,children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Add App"]})]}),e.jsx(L,{children:e.jsx("div",{className:"space-y-3",children:m.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-orange-400 to-orange-600 rounded-lg flex items-center justify-center",children:e.jsx(Ge,{className:"w-4 h-4 text-white"})}),e.jsx("div",{children:e.jsx("p",{className:"font-medium text-sm",children:s.name})})]}),e.jsx(N,{variant:"secondary",className:"bg-green-100 text-green-800",children:"Active"})]},s.id))})})]})]})}),e.jsxs(k,{value:"users",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Group Users"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage users assigned to this group"})]}),e.jsxs(x,{onClick:B,className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Add User"]})]}),e.jsx(z,{data:d,columns:de,loading:!1,tableStyle:"border rounded-lg bg-white",tableHeadClassName:"text-[#4A36EC] font-semibold"})]}),e.jsxs(k,{value:"applications",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Group Applications"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage applications assigned to this group"})]}),e.jsxs(x,{onClick:F,className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Add Application"]})]}),e.jsx(z,{data:m,columns:ce,loading:!1,tableStyle:"border rounded-lg bg-white",tableHeadClassName:"text-[#4A36EC] font-semibold"})]})]})})]})}export{We as default};
