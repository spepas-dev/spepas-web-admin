import{c as E,f as C,r as p,g as G,j as e,F as U,i as h,k as g,l as b,n as y,o as v,e as u,p as j,q as I,ab as F,ay as M,bj as w,U as L,s as D,v as T,w as _,C as B,m as K,D as k,x as S}from"./index-BEfPUQd3.js";import{u as P}from"./modal-helpers-u5ghZSiS.js";import{u as H}from"./useMutation-CxnX3va-.js";import{G as V,g as R,u as q}from"./gopas.queries-jntJAyfW.js";import{s as z}from"./zod-DPUoip6C.js";import{z as n}from"./index-3Gi9B8Cu.js";import{M as f}from"./multi-select-DEp3z63F.js";import{u as Q}from"./users.queries-BzwIn2G9.js";import{P as O}from"./plus-D6nxsE-o.js";import"./dialog-DfEuW_jS.js";import"./separator-DpEqoi9c.js";import"./circle-x-Bb9PP882.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"m15 12-8.373 8.373a1 1 0 1 1-3-3L12 9",key:"eefl8a"}],["path",{d:"m18 15 4-4",key:"16gjal"}],["path",{d:"m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172V7l-2.26-2.26a6 6 0 0 0-4.202-1.756L9 2.96l.92.82A6.18 6.18 0 0 1 12 8.4V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5",key:"b7pghm"}]],W=E("Hammer",Y),J=()=>{const t=C();return H({mutationFn:l=>V.registerGopa(l),onSuccess:()=>{t.invalidateQueries({queryKey:R.all})}})},X=n.object({User_ID:n.string().min(1,"Please select a user"),Specialties:n.array(n.string()).min(1,"Add at least one specialty")}),Z=[{value:"TYRES",label:"Tyres"},{value:"FAN_BELT",label:"Fan Belt"},{value:"ENGINE",label:"Engine"},{value:"BRAKES",label:"Brakes"},{value:"TRANSMISSION",label:"Transmission"},{value:"ELECTRICAL",label:"Electrical"},{value:"AC_SYSTEM",label:"AC System"},{value:"SUSPENSION",label:"Suspension"}];function $({onSubmit:t,loading:l=!1}){const{data:r,isLoading:x,isError:c}=Q(),d=p.useMemo(()=>{var s;return((s=r==null?void 0:r.data)==null?void 0:s.map(a=>({value:a.User_ID,label:a.name})))||[]},[r==null?void 0:r.data]),i=G({resolver:z(X),defaultValues:{User_ID:"",Specialties:[]}}),m=s=>{const a={User_ID:s.User_ID,Specialties:s.Specialties};t(a),i.reset()};return e.jsx(U,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(m),className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"flex gap-4 items-start",children:e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsx(h,{control:i.control,name:"User_ID",render:({field:s})=>e.jsxs(g,{children:[e.jsx(b,{className:"text-gray-700",children:"Select User"}),e.jsx(y,{children:e.jsx(f,{options:d,value:[s.value],onValueChange:a=>s.onChange(a[0]),placeholder:"Select a user",maxCount:1,variant:"default",disabled:l})}),e.jsx(v,{className:"text-red-500"})]})}),e.jsx(h,{control:i.control,name:"Specialties",render:({field:s})=>e.jsxs(g,{children:[e.jsx(b,{className:"text-gray-700",children:"Specialties"}),e.jsx(y,{children:e.jsx(f,{options:Z,value:s.value,onValueChange:s.onChange,placeholder:"Select specialties",variant:"secondary",disabled:l})}),e.jsx(v,{className:"text-red-500"})]})})]})})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(u,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",disabled:l,children:l?"Saving...":"Save Gopa"})})]})})}function pe(){const{data:t,isLoading:l}=q(),r=p.useMemo(()=>(t==null?void 0:t.data)||[],[t==null?void 0:t.data]),x=p.useMemo(()=>[{header:"Name",accessorKey:"name"},{header:"Email",accessorKey:"email"},{header:"Specialties",accessorKey:"specialties",cell:({row:a})=>{var o;return e.jsx("div",{className:"flex flex-wrap gap-1",children:(o=a.original.specialties)==null?void 0:o.map((N,A)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:N},A))})}},{header:"Status",accessorKey:"status",cell:({row:a})=>{const o=a.original.status===1;return e.jsxs("span",{className:j("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",o?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:[e.jsx("span",{className:j("w-1.5 h-1.5 rounded-full mr-1.5",o?"bg-green-400":"bg-red-400")}),o?"Active":"Inactive"]})}},{header:"Date Added",accessorKey:"createdAt",cell:({row:a})=>e.jsx("div",{children:I(a.original.createdAt,"dd/MM/yyyy HH:mm:ss a")})},{header:"Actions",accessorKey:"actions",cell:()=>e.jsxs(u,{size:"sm",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"View"]})}],[]),c=P(),d=()=>{c.openForm({title:"Add New Gopa",children:e.jsx($,{onSubmit:m,loading:!1}),showFooter:!1})},{mutateAsync:i}=J(),m=async a=>{try{await i(a),S.success("Gopa created successfully")}catch{S.error("Failed to create gopa")}finally{c.close()}},s=[{title:"Total gopa",value:r.length,Icon:M,description:"Active gopa in system",trend:"+3.2%",trendUp:!0},{title:"Specialties",value:"10",Icon:W,description:"Different specializations",trend:"+2.4%",trendUp:!0},{title:"Average Skills",value:"10",Icon:w,description:"Skills per mechanic",trend:"+1.8%",trendUp:!0},{title:"Pending Approvals",value:"5",Icon:L,description:"gopa awaiting approval",trend:"+0.9%",trendUp:!1}];return e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsx(D,{items:T.threeTier("User Management","/user-management","Goro")}),e.jsx(_,{title:"Gopa",description:"Manage gopa and their specialties",actions:e.jsxs(u,{onClick:d,className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Add Gopa"]})}),e.jsx(B,{cards:s}),e.jsx(K.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:e.jsx(k,{data:r,columns:x,loading:l,tableStyle:"border rounded-lg bg-white",tableHeadClassName:"text-[#4A36EC] font-semibold"})})]})}export{pe as default};
