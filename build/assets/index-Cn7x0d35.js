import{f as F,r as d,g as I,h as w,j as e,F as M,i as j,k as b,l as f,n as v,I as P,o as N,H as T,J as B,K as _,L as k,N as K,e as x,P as L,s as q,v as z,w as H,C as U,aA as C,m as V,D as Q,t as S}from"./index-BEfPUQd3.js";import{u as $}from"./modal-helpers-u5ghZSiS.js";import{u as D}from"./useMutation-CxnX3va-.js";import{C as G,c as J,u as A}from"./categoryQueries-I5xNgTW2.js";import{s as R}from"./zod-DPUoip6C.js";import{z as m}from"./index-3Gi9B8Cu.js";import{T as O}from"./trash-2-DQhLckhX.js";import{P as E}from"./plus-D6nxsE-o.js";import"./dialog-DfEuW_jS.js";const W=()=>{const i=F();return D({mutationFn:a=>G.createCategory(a),onSuccess:()=>{i.invalidateQueries({queryKey:J.all})}})},X=m.object({name:m.string().min(1,"Category name is required"),parent_ID:m.string().nullable()}),Y=m.object({categories:m.array(X).min(1,"Add at least one category")}),Z=({onSubmit:i,loading:a=!1})=>{const{data:s}=A(),u=d.useMemo(()=>(s==null?void 0:s.data)||[],[s==null?void 0:s.data]),r=d.useMemo(()=>u.map(o=>({id:o.Category_ID,name:o.name})),[u]),t=I({resolver:R(Y),defaultValues:{categories:[{name:"",parent_ID:null}]}}),{fields:g,remove:h,append:p}=w({control:t.control,name:"categories"}),y=o=>{i(o.categories),t.reset()};return e.jsx(M,{...t,children:e.jsx("form",{onSubmit:t.handleSubmit(y),className:"space-y-6",children:e.jsxs("div",{className:"space-y-4",children:[g.map((o,l)=>e.jsxs("div",{className:"flex gap-4 items-start",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsx(j,{control:t.control,name:`categories.${l}.name`,render:({field:c})=>e.jsxs(b,{children:[e.jsx(f,{className:"text-gray-700",children:"Name"}),e.jsx(v,{children:e.jsx(P,{placeholder:"Enter category name",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",disabled:a,...c})}),e.jsx(N,{className:"text-red-500"})]})}),e.jsx(j,{control:t.control,name:`categories.${l}.parent_ID`,render:({field:c})=>e.jsxs(b,{children:[e.jsx(f,{className:"text-gray-700",children:"Parent Category"}),e.jsx(v,{children:e.jsxs(T,{value:c.value,onValueChange:n=>c.onChange(n),disabled:a,children:[e.jsx(B,{className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",children:e.jsx(_,{placeholder:"Select a Category"})}),e.jsx(k,{children:r.map(n=>e.jsx(K,{value:n.id,children:n.name},n.id))})]})}),e.jsx(N,{className:"text-red-500"})]})})]}),g.length>1&&e.jsx(x,{type:"button",variant:"outline",size:"icon",className:"mt-6 hover:bg-gray-100",onClick:()=>h(l),children:e.jsx(O,{className:"w-4 h-4 text-gray-600"})})]},o.id)),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(x,{type:"button",variant:"outline",className:"hover:bg-gray-100",onClick:()=>p({name:"",parent_ID:""}),disabled:a,children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Add Another"]}),e.jsx(x,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",disabled:a,children:a?"Saving...":"Save Categories"})]})]})})})};function le(){const i=$(),[a,s]=d.useState(!1),u=W(),{data:r,isLoading:t,isError:g}=A(),h=d.useMemo(()=>(r==null?void 0:r.data)||[],[r==null?void 0:r.data]);console.log(h);const p=d.useMemo(()=>[{header:"Name",accessorKey:"name"}],[]),y=async c=>{s(!0);try{await u.mutateAsync(c),S.success("Categories created successfully"),i.close()}catch(n){console.error("Error creating categories:",n),S.error("Failed to create categories. Please try again.")}finally{s(!1)}},o=()=>{i.openForm({title:"Add Category",size:"md",showFooter:!1,children:e.jsx(Z,{onSubmit:y,loading:a})})},l=[{title:"Total Categories",value:0,Icon:C,description:"Active categories",trend:"+2.5%",trendUp:!0},{title:"Car Models Categories",value:0,Icon:C,description:"Active categories",trend:"+1.5%",trendUp:!0},{title:"Spare Parts Categories",value:0,Icon:C,description:"Spare parts categories",trend:"+3.5%",trendUp:!0}];return t?e.jsx("div",{className:"p-8 space-y-8",children:e.jsx(L,{})}):g?e.jsx("div",{children:"Error loading categories"}):e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsx(q,{items:z.threeTier("Inventory","/inventory","Categories")}),e.jsx(H,{title:"Categories",description:"Manage categories and their specifications",actions:e.jsxs(x,{onClick:o,className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Add Category"]})}),e.jsx(U,{cards:l}),e.jsx(V.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:e.jsx(Q,{columns:p,data:h,placeholder:"Search categories...",tableStyle:"border rounded-lg bg-white",tableHeadClassName:"text-[#4A36EC] font-semibold"})})]})}export{le as default};
