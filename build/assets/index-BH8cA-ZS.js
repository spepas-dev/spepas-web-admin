import{E as F,ar as N,f as w,g as I,h as P,j as e,F as T,i as p,k as g,l as b,n as q,I as K,o as j,as as B,e as m,r as x,p as v,q as k,at as D,au as H,a as U,a9 as z,P as L,s as Q,v as V,w as $,C as G,m as O,D as R,x as M}from"./index-BEfPUQd3.js";import{u as J}from"./modal-helpers-u5ghZSiS.js";import{u as W}from"./useMutation-CxnX3va-.js";import{s as X}from"./zod-DPUoip6C.js";import{o as A,a as Y,s as C}from"./index-3Gi9B8Cu.js";import{T as Z}from"./trash-2-DQhLckhX.js";import{P as S}from"./plus-D6nxsE-o.js";import"./dialog-DfEuW_jS.js";const u={all:["manufactures"],detail:a=>[...u.all,"detail",a],lists:()=>[...u.all,"list"],list:a=>[...u.lists(),a],stats:()=>[...u.all,"stats"]},_=a=>F({queryKey:u.list({}),queryFn:()=>N.getManufactures(a)}),ee=()=>{const a=w();return W({mutationFn:r=>N.createManufacturer(r),onSuccess:()=>{a.invalidateQueries({queryKey:u.all})}})},ae=A({name:C().min(1,"Manufacturer name is required"),country:C().min(1,"Country is required")}),re=A({manufacturers:Y(ae).min(1,"Add at least one manufacturer")});function se({onSubmit:a,loading:r=!1}){const s=I({resolver:X(re),defaultValues:{manufacturers:[{name:"",country:""}]}}),{fields:i,append:f,remove:y}=P({control:s.control,name:"manufacturers"}),c=o=>{a(o.manufacturers),s.reset()};return e.jsx(T,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(c),className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:i.map((o,l)=>e.jsxs("div",{className:"flex gap-4 items-start",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsx(p,{control:s.control,name:`manufacturers.${l}.name`,render:({field:t})=>e.jsxs(g,{children:[e.jsx(b,{className:"text-gray-700",children:"Name"}),e.jsx(q,{children:e.jsx(K,{placeholder:"Enter manufacturer name",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",disabled:r,...t})}),e.jsx(j,{className:"text-red-500"})]})}),e.jsx(p,{control:s.control,name:`manufacturers.${l}.country`,render:({field:t})=>e.jsxs(g,{children:[e.jsx(b,{className:"text-gray-700",children:"Country"}),e.jsx(B,{placeholder:"Enter country",defaultValue:t.value,onChange:h=>t.onChange(h.name),disabled:r}),e.jsx(j,{className:"text-red-500"})]})})]}),i.length>1&&e.jsx(m,{type:"button",variant:"outline",size:"icon",className:"mt-8 hover:bg-gray-100",onClick:()=>y(l),disabled:r,children:e.jsx(Z,{className:"w-4 h-4 text-gray-600"})})]},o.id))}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(m,{type:"button",variant:"outline",className:"hover:bg-gray-100",onClick:()=>f({name:"",country:""}),disabled:r,children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Add Another"]}),e.jsx(m,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",disabled:r,children:r?"Saving...":"Save Manufacturers"})]})]})})}function me(){const[a,r]=x.useState(!1),s=ee(),i=J(),f=async n=>{r(!0);try{await s.mutateAsync(n),M.success(`${n.length} manufacturer(s) created successfully`),i.close()}catch(d){console.error("Error creating manufacturers:",d),M.error("Failed to create manufacturers. Please try again.")}finally{r(!1)}},y=()=>{i.openForm({title:"Add Manufacturer",size:"md",showFooter:!1,children:e.jsx(se,{onSubmit:f,loading:a})})},{data:c,isLoading:o,isError:l}=_(),t=x.useMemo(()=>(c==null?void 0:c.data)||[],[c]),h=x.useMemo(()=>[{header:"Name",accessorKey:"name"},{header:"Country",accessorKey:"country"},{header:"Status",accessorKey:"status",cell:({row:n})=>{const d=n.original.status===1;return e.jsxs("span",{className:v("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",d?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:[e.jsx("span",{className:v("w-1.5 h-1.5 rounded-full mr-1.5",d?"bg-green-400":"bg-red-400")}),d?"Active":"Inactive"]})}},{header:"Created On",accessorKey:"createdAt",cell:({row:n})=>e.jsx("span",{children:k(new Date(n.original.createdAt),"yyyy/MM/dd HH:mm:a")})}],[]),E=[{title:"Total Manufacturers",value:t.length,Icon:D,description:"Active manufacturers in the system",trend:"+2.5%",trendUp:!0},{title:"Countries",value:new Set(t.map(n=>n.country)).size,Icon:H,description:"Countries represented",trend:"+1.2%",trendUp:!0},{title:"Vehicle Models",value:234,Icon:U,description:"Associated vehicle models",trend:"+5.4%",trendUp:!0},{title:"Parts Categories",value:56,Icon:z,description:"Available part categories",trend:"+3.1%",trendUp:!0}];return o?e.jsx("div",{className:"p-8 space-y-8",children:e.jsx(L,{})}):l?e.jsx("div",{children:"Error loading manufacturers"}):e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsx(Q,{items:V.threeTier("Inventory","/inventory","Manufacturers")}),e.jsx($,{title:"Manufacturers",description:"Manage car manufacturers in the system",actions:e.jsxs(m,{onClick:y,className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Add Manufacturer"]})}),e.jsx(G,{cards:E}),e.jsx(O.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:e.jsx(R,{columns:h,data:t,loading:o,tableStyle:"border rounded-lg bg-white",tableHeadClassName:"text-[#4A36EC] font-semibold"})})]})}export{me as default};
