import{A as i,i as I,k as M,j as e,S as x,U as A,a as b,r as p,l as P,n as R,m as S}from"./index-CG3cDFil.js";import{D as U}from"./index-DVvBrNmU.js";import{C as $}from"./card-grid-DHAopdjS.js";import{u as _,a as k,F as q,b as h,c as j,d as g,e as y,f}from"./form-_i_eYalU.js";import{u as B}from"./useMutation-CVaQmNh4.js";import{u as O}from"./useQuery-Nb54E3uG.js";import{s as G,o as w,a as E,b as v}from"./index-Cksdco4c.js";import{D as K,a as Q,b as V,c as J,d as H}from"./dialog-V-TE0CwV.js";import{I as z}from"./input-0St3XTHq.js";import{M as D}from"./multi-select-CynJAMoS.js";import{T as W}from"./textarea-DGzpSrm1.js";import{T as X}from"./trash-2-X-Fq5KTG.js";import{P as T}from"./plus-CgI7Ta1y.js";import{C as Y}from"./circle-user-tnq97Czk.js";import{L as Z}from"./lock-BGQdcYA5.js";import"./table-CXQMyFfb.js";import"./sliders-horizontal-cnWW7Bce.js";import"./x-BgpYH4Yb.js";import"./select-xgui-4X2.js";import"./arrow-left-D8MtdBnI.js";import"./arrow-right-iy4TempS.js";import"./card-TUnhNMrf.js";import"./popover-P3KGh40z.js";import"./globe-CvmVd3kB.js";import"./badge-CWZmtTXQ.js";import"./wand-sparkles-C-ss3xfk.js";const c=I.ACCESS_MANAGEMENT.ROLE;class F{static async getRole(s){return i.get(c.DETAIL(s))}static async createRole(s){return i.post(c.CREATE,s)}static async updateRole(s,n){return i.put(`${c}/${s}`,n)}static async deleteRole(s){return i.delete(`${c}/${s}`)}static async getRoleList(s){return i.get(c.BASE,{params:s})}static async getRoleStats(s){return i.get(`${c}/${s}/stats`)}}const m={all:["role"],list:()=>[...m.all,"list"],details:t=>[...m.all,"details",t],stats:t=>[...m.all,"stats",t]},ee=()=>O({queryKey:m.list(),queryFn:()=>F.getRoleList()}),se=()=>{const t=M();return B({mutationFn:s=>F.createRole(s),onSuccess:()=>{t.invalidateQueries({queryKey:m.all})}})},ae=w({name:v().min(1,"Role name is required"),description:v().min(10,"Description must be at least 10 characters"),permissions:E(v()).min(1,"Select at least one permission"),users:E(v())}),re=w({roles:E(ae).min(1,"Add at least one role")}),te=[{value:"view_dashboard",label:"View Dashboard",icon:x},{value:"manage_users",label:"Manage Users",icon:x},{value:"manage_inventory",label:"Manage Inventory",icon:x},{value:"generate_reports",label:"Generate Reports",icon:x}],oe=[{value:"user1",label:"John Doe",icon:A},{value:"user2",label:"Jane Smith",icon:A},{value:"user3",label:"Bob Johnson",icon:A}];function le({open:t,onOpenChange:s,onSubmit:n}){const a=_({resolver:G(re),defaultValues:{roles:[{name:"",description:"",permissions:[],users:[]}]}}),{fields:o,append:N,remove:d}=k({control:a.control,name:"roles"}),C=u=>{n(u.roles),a.reset()};return e.jsx(K,{open:t,onOpenChange:s,children:e.jsxs(Q,{className:"max-w-2xl bg-white",children:[e.jsxs(V,{children:[e.jsx(J,{className:"text-[#4A36EC] text-xl font-bold",children:"Add Roles"}),e.jsx(H,{className:"text-gray-600",children:"Create new roles and assign permissions"})]}),e.jsx(q,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(C),className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:o.map((u,l)=>e.jsxs("div",{className:"flex gap-4 items-start",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsx(h,{control:a.control,name:`roles.${l}.name`,render:({field:r})=>e.jsxs(j,{children:[e.jsx(g,{className:"text-gray-700",children:"Role Name"}),e.jsx(y,{children:e.jsx(z,{placeholder:"Enter role name",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",...r})}),e.jsx(f,{className:"text-red-500"})]})}),e.jsx(h,{control:a.control,name:`roles.${l}.description`,render:({field:r})=>e.jsxs(j,{children:[e.jsx(g,{className:"text-gray-700",children:"Description"}),e.jsx(y,{children:e.jsx(W,{placeholder:"Enter role description",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",...r})}),e.jsx(f,{className:"text-red-500"})]})}),e.jsx(h,{control:a.control,name:`roles.${l}.permissions`,render:({field:r})=>e.jsxs(j,{children:[e.jsx(g,{className:"text-gray-700",children:"Permissions"}),e.jsx(y,{children:e.jsx(D,{options:te,value:r.value,onValueChange:r.onChange,placeholder:"Select permissions",maxCount:2,animation:.3,variant:"secondary",modalPopover:!0})}),e.jsx(f,{className:"text-red-500"})]})}),e.jsx(h,{control:a.control,name:`roles.${l}.users`,render:({field:r})=>e.jsxs(j,{children:[e.jsx(g,{className:"text-gray-700",children:"Assign Users"}),e.jsx(y,{children:e.jsx(D,{options:oe,value:r.value,onValueChange:r.onChange,placeholder:"Select users",maxCount:3,animation:.3,variant:"default",modalPopover:!0})}),e.jsx(f,{className:"text-red-500"})]})})]}),o.length>1&&e.jsx(b,{type:"button",variant:"outline",size:"icon",className:"mt-8 hover:bg-gray-100",onClick:()=>d(l),children:e.jsx(X,{className:"w-4 h-4 text-gray-600"})})]},u.id))}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(b,{type:"button",variant:"outline",className:"hover:bg-gray-100",onClick:()=>N({name:"",description:"",permissions:[],users:[]}),children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Add Another"]}),e.jsx(b,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:"Save Roles"})]})]})})]})})}function Ie(){const[t,s]=p.useState(!1),[n,a]=p.useState([]),{data:o,isError:N,isLoading:d}=ee();p.useEffect(()=>(o&&a(o.data),()=>{a([])}),[o==null?void 0:o.data]);const C=p.useMemo(()=>[{header:"Role Name",accessorKey:"name"}],[]),{mutate:u}=se(),l=async L=>{console.log(L),s(!1)},r=[{title:"Total Roles",value:n.length,Icon:Y,description:"Active roles in system",trend:"+2.1%",trendUp:!0},{title:"Access Levels",value:5,Icon:Z,description:"Security levels",trend:"+0.9%",trendUp:!0}];return d?e.jsx("div",{className:"p-8 space-y-8",children:e.jsx(P,{})}):N?e.jsx("div",{children:"Error loading roles"}):e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx("a",{href:"/",className:"hover:text-[#4A36EC]",children:"Dashboard"}),e.jsx(R,{className:"w-4 h-4 mx-2"}),e.jsx("a",{href:"/access-control",className:"hover:text-[#4A36EC]",children:"Access Control"}),e.jsx(R,{className:"w-4 h-4 mx-2"}),e.jsx("span",{className:"text-[#4A36EC] font-medium",children:"Roles"})]}),e.jsxs(S.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-[#4A36EC]",children:"Roles"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage user roles and their permissions"})]}),e.jsxs(b,{onClick:()=>s(!0),className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Add Role"]})]}),e.jsx($,{cards:r}),e.jsx(S.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:e.jsx(U,{data:n,columns:C,loading:d,tableStyle:"border rounded-lg bg-white",tableHeadClassName:"text-[#4A36EC] font-semibold"})}),e.jsx(le,{open:t,onOpenChange:s,onSubmit:l})]})}export{Ie as default};
