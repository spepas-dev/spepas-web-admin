import{A as I,e as n,b as w,j as e,S as A,a as v,r as f,c as E,P as L,m as M,d as C}from"./index-C2Q_LmeJ.js";import{B as D}from"./badge-rX3Jh1SJ.js";import{C as _}from"./card-grid-CZ4tobzV.js";import{u as T,F as B,b as y,c as j,d as b,e as R,f as N}from"./form-CcMvRR1f.js";import{B as K,a as q,P as U}from"./pageHeader-7vhK00zh.js";import{D as $}from"./index-CvxHYYsL.js";import{u as G}from"./modal-helpers-CaXMt30Z.js";import{u as H}from"./useMutation-TZLAPFAD.js";import{u as Q}from"./useQuery-CUE0UVvY.js";import{s as O,z as m}from"./index-DyAPY9a1.js";import{I as k}from"./input-fvZZM-h7.js";import{M as z}from"./multi-select-GP_yjtwv.js";import{T as V}from"./textarea-BuBMhKBk.js";import{u as J}from"./permission.queries-CcQJMFaF.js";import{C as W}from"./circle-user-DhR_HMOe.js";import{L as X}from"./lock-DGEHZT47.js";import{P as Y}from"./plus-BFloapdy.js";import{f as Z}from"./format-CBpsKyOP.js";import"./card-CVylEmF3.js";import"./popover-CI77UgAE.js";import"./globe-C44rbEdp.js";import"./table-CAIVgxvw.js";import"./dialog-BxdRvcNA.js";import"./select-K8uUziWX.js";import"./arrow-left-DT7SArHl.js";import"./arrow-right-Ct_-AZHB.js";import"./utils-km2FGkQ4.js";import"./separator-q4J_vRT3.js";import"./circle-x-DWBwq746.js";import"./wand-sparkles-JjYTZCVz.js";const c=I.ACCESS_MANAGEMENT.ROLE;class S{static async getRole(s){return n.get(c.DETAIL(s))}static async createRole(s){return n.post(c.CREATE,s)}static async updateRole(s,i){return n.put(`${c}/${s}`,i)}static async deleteRole(s){return n.delete(`${c}/${s}`)}static async getRoleList(s){return n.get(c.BASE,{params:s})}static async getRoleStats(s){return n.get(`${c}/${s}/stats`)}}const d={all:["role"],list:()=>[...d.all,"list"],details:t=>[...d.all,"details",t],stats:t=>[...d.all,"stats",t]},ee=()=>Q({queryKey:d.list(),queryFn:()=>S.getRoleList()}),se=()=>{const t=w();return H({mutationFn:s=>S.createRole(s),onSuccess:()=>{t.invalidateQueries({queryKey:d.all})}})},re=m.object({role_name:m.string().min(1,"Role name is required"),description:m.string().min(1,"Description is required"),permissions:m.array(m.string()).min(1,"At least one permission is required")});function te({onSubmit:t,loading:s=!1}){const{data:i}=J(),u=i==null?void 0:i.data.map(r=>({value:r.permissionID,label:r.title})),a=T({resolver:O(re),defaultValues:{role_name:"",description:"",permissions:[]}}),x=r=>{const h={role_name:r.role_name,rolePermissions:r.permissions.map(g=>({permissionID:g}))};t(h)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5 text-[#4A36EC]"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Role Information"})]}),e.jsx(B,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(x),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1  gap-4",children:[e.jsx(y,{control:a.control,name:"role_name",render:({field:r})=>e.jsxs(j,{children:[e.jsx(b,{className:"text-gray-700",children:"Role Name *"}),e.jsx(R,{children:e.jsx(k,{...r,placeholder:"Enter role name",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",disabled:s})}),e.jsx(N,{className:"text-red-500"})]})}),e.jsx(y,{control:a.control,name:"description",render:({field:r})=>e.jsxs(j,{children:[e.jsx(b,{className:"text-gray-700",children:"Description *"}),e.jsx(R,{children:e.jsx(V,{...r,placeholder:"Enter role description",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",disabled:s,rows:3})}),e.jsx(N,{className:"text-red-500"})]})})]}),e.jsx(y,{control:a.control,name:"permissions",render:({field:r})=>e.jsxs(j,{children:[e.jsx(b,{className:"text-gray-700",children:"Permissions *"}),e.jsx(R,{children:e.jsx(z,{options:u||[],value:r.value||[],onValueChange:r.onChange,placeholder:"Select permissions",disabled:s})}),e.jsx(N,{className:"text-red-500"})]})}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs(v,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",disabled:s,children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),s?"Creating...":"Create Role"]})})]})})]})}function De(){const[t,s]=f.useState([]),i=se(),u=G(),{data:a,isError:x,isLoading:r}=ee();f.useEffect(()=>(a&&s(a.data),()=>{s([])}),[a==null?void 0:a.data]);const h=f.useMemo(()=>[{header:"Role Name",accessorKey:"role_name"},{header:"Description",accessorKey:"description"},{header:"Permissions",accessorKey:"rolePermissions",cell:({row:l})=>{const o=l.original.permissions;return e.jsx("div",{className:"flex flex-wrap gap-2",children:o.map(p=>e.jsx(D,{children:p.permissionID},p.permissionID))})}},{header:"Status",accessorKey:"status",cell:({row:l})=>{const o=l.original.status===1;return e.jsxs("span",{className:E("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",o?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:[e.jsx("span",{className:E("w-1.5 h-1.5 rounded-full mr-1.5",o?"bg-green-400":"bg-red-400")}),o?"Active":"Inactive"]})}},{header:"Created On",accessorKey:"date_added",cell:({row:l})=>e.jsx("span",{children:Z(l.original.date_added,"dd/MM/yyyy HH:mm:ss a")})}],[]),g=async l=>{try{const{description:o,...p}=l;await i.mutateAsync(p),C.success("Role created successfully"),u.close()}catch(o){console.error("Error creating role:",o),C.error("Failed to create role. Please try again.")}},P=()=>{u.openForm({title:"Create New Role",size:"lg",showFooter:!1,children:e.jsx(te,{onSubmit:g})})},F=[{title:"Total Roles",value:t.length,Icon:W,description:"Active roles in system",trend:"+2.1%",trendUp:!0},{title:"Access Levels",value:5,Icon:X,description:"Security levels",trend:"+0.9%",trendUp:!0},{title:"Permissions",value:12,Icon:A,description:"Total permissions",trend:"+1.5%",trendUp:!0}];return r?e.jsx("div",{className:"p-8 space-y-8",children:e.jsx(L,{})}):x?e.jsx("div",{children:"Error loading roles"}):e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsx(K,{items:q.threeTier("Access Control","/access-control","Roles")}),e.jsx(U,{title:"Roles",description:"Manage user roles and their permissions",actions:e.jsxs(v,{onClick:P,className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"Add Role"]})}),e.jsx(_,{cards:F}),e.jsx(M.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:e.jsx($,{data:t,columns:h,loading:r,tableStyle:"border rounded-lg bg-white",tableHeadClassName:"text-[#4A36EC] font-semibold"})})]})}export{De as default};
