import{c as M,y as F,z as n,E as I,f as w,g as L,j as e,S as N,F as _,i as y,k as j,l as b,n as f,I as D,o as R,e as C,r as v,G as T,p as E,q,P as K,s as B,v as U,w as k,C as $,m as G,D as H,x as A}from"./index-BEfPUQd3.js";import{u as Q}from"./modal-helpers-u5ghZSiS.js";import{u as z}from"./useMutation-CxnX3va-.js";import{s as O}from"./zod-DPUoip6C.js";import{z as d}from"./index-3Gi9B8Cu.js";import{M as V}from"./multi-select-DEp3z63F.js";import{T as J}from"./textarea-BpM5EgwI.js";import{u as W}from"./permission.queries-BW_YAYP2.js";import{L as X}from"./lock-BqMNhkTp.js";import{P as Y}from"./plus-D6nxsE-o.js";import"./dialog-DfEuW_jS.js";import"./separator-DpEqoi9c.js";import"./circle-x-Bb9PP882.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],ee=M("CircleUser",Z),c=F.ACCESS_MANAGEMENT.ROLE;class S{static async getRole(s){return n.get(c.DETAIL(s))}static async createRole(s){return n.post(c.CREATE,s)}static async updateRole(s,t){return n.put(`${c}/${s}`,t)}static async deleteRole(s){return n.delete(`${c}/${s}`)}static async getRoleList(s){return n.get(c.BASE,{params:s})}static async getRoleStats(s){return n.get(`${c}/${s}/stats`)}}const m={all:["role"],list:()=>[...m.all,"list"],details:a=>[...m.all,"details",a],stats:a=>[...m.all,"stats",a]},se=()=>I({queryKey:m.list(),queryFn:()=>S.getRoleList()}),re=()=>{const a=w();return z({mutationFn:s=>S.createRole(s),onSuccess:()=>{a.invalidateQueries({queryKey:m.all})}})},te=d.object({role_name:d.string().min(1,"Role name is required"),description:d.string().min(1,"Description is required"),permissions:d.array(d.string()).min(1,"At least one permission is required")});function ae({onSubmit:a,loading:s=!1}){const{data:t}=W(),x=t==null?void 0:t.data.map(r=>({value:r.permissionID,label:r.title})),o=L({resolver:O(te),defaultValues:{role_name:"",description:"",permissions:[]}}),u=r=>{const h={role_name:r.role_name,rolePermissions:r.permissions.map(g=>({permissionID:g}))};a(h)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"h-5 w-5 text-[#4A36EC]"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Role Information"})]}),e.jsx(_,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(u),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1  gap-4",children:[e.jsx(y,{control:o.control,name:"role_name",render:({field:r})=>e.jsxs(j,{children:[e.jsx(b,{className:"text-gray-700",children:"Role Name *"}),e.jsx(f,{children:e.jsx(D,{...r,placeholder:"Enter role name",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",disabled:s})}),e.jsx(R,{className:"text-red-500"})]})}),e.jsx(y,{control:o.control,name:"description",render:({field:r})=>e.jsxs(j,{children:[e.jsx(b,{className:"text-gray-700",children:"Description *"}),e.jsx(f,{children:e.jsx(J,{...r,placeholder:"Enter role description",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",disabled:s,rows:3})}),e.jsx(R,{className:"text-red-500"})]})})]}),e.jsx(y,{control:o.control,name:"permissions",render:({field:r})=>e.jsxs(j,{children:[e.jsx(b,{className:"text-gray-700",children:"Permissions *"}),e.jsx(f,{children:e.jsx(V,{options:x||[],value:r.value||[],onValueChange:r.onChange,placeholder:"Select permissions",disabled:s})}),e.jsx(R,{className:"text-red-500"})]})}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs(C,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",disabled:s,children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),s?"Creating...":"Create Role"]})})]})})]})}function je(){const a=re(),s=Q(),{data:t,isError:x,isLoading:o}=se(),u=v.useMemo(()=>(t==null?void 0:t.data)||[],[t==null?void 0:t.data]),r=v.useMemo(()=>[{header:"Role Name",accessorKey:"role_name"},{header:"Description",accessorKey:"description"},{header:"Permissions",accessorKey:"rolePermissions",cell:({row:l})=>{const i=l.original.permissions;return e.jsx("div",{className:"flex flex-wrap gap-2",children:i.map(p=>e.jsx(T,{children:p.title},p.permissionID))})}},{header:"Status",accessorKey:"status",cell:({row:l})=>{const i=l.original.status===1;return e.jsxs("span",{className:E("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",i?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:[e.jsx("span",{className:E("w-1.5 h-1.5 rounded-full mr-1.5",i?"bg-green-400":"bg-red-400")}),i?"Active":"Inactive"]})}},{header:"Created On",accessorKey:"date_added",cell:({row:l})=>e.jsx("span",{children:q(l.original.date_added,"dd/MM/yyyy HH:mm:ss a")})}],[]),h=async l=>{try{const{description:i,...p}=l;await a.mutateAsync(p),A.success("Role created successfully"),s.close()}catch(i){console.error("Error creating role:",i),A.error("Failed to create role. Please try again.")}},g=()=>{s.openForm({title:"Create New Role",size:"lg",showFooter:!1,children:e.jsx(ae,{onSubmit:h})})},P=[{title:"Total Roles",value:u.length,Icon:ee,description:"Active roles in system",trend:"+2.1%",trendUp:!0},{title:"Access Levels",value:5,Icon:X,description:"Security levels",trend:"+0.9%",trendUp:!0},{title:"Permissions",value:12,Icon:N,description:"Total permissions",trend:"+1.5%",trendUp:!0}];return o?e.jsx("div",{className:"p-8 space-y-8",children:e.jsx(K,{})}):x?e.jsx("div",{children:"Error loading roles"}):e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsx(B,{items:U.threeTier("Access Management","/access-management","Roles")}),e.jsx(k,{title:"Roles",description:"Manage user roles and their permissions",actions:e.jsxs(C,{onClick:g,className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"Add Role"]})}),e.jsx($,{cards:P}),e.jsx(G.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:e.jsx(H,{data:u,columns:r,loading:o,tableStyle:"border rounded-lg bg-white",tableHeadClassName:"text-[#4A36EC] font-semibold"})})]})}export{je as default};
