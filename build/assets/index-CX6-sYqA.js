import{b as v,j as e,q as A,a as x,r as m,c as g,m as K,d as p}from"./index-C2Q_LmeJ.js";import{B,a as T,P as k}from"./pageHeader-7vhK00zh.js";import{D as z}from"./index-CvxHYYsL.js";import{u as Q}from"./modal-helpers-CaXMt30Z.js";import{C as G}from"./card-grid-CZ4tobzV.js";import{u as H,F as L,b as f,c as j,d as y,e as b,f as C}from"./form-CcMvRR1f.js";import{u as E}from"./useMutation-TZLAPFAD.js";import{A as F,a as w,u as R}from"./applications.queries-BK7IP6Ii.js";import{s as $,z as u}from"./index-DyAPY9a1.js";import{I as V}from"./input-fvZZM-h7.js";import{T as X}from"./textarea-BuBMhKBk.js";import{U as J}from"./user-plus-Ku2xa0I_.js";import{a as O,C as W}from"./clock-CtmsjA65.js";import{C as Y}from"./circle-x-DWBwq746.js";import{P as Z}from"./plus-BFloapdy.js";import"./table-CAIVgxvw.js";import"./dialog-BxdRvcNA.js";import"./select-K8uUziWX.js";import"./arrow-left-DT7SArHl.js";import"./arrow-right-Ct_-AZHB.js";import"./card-CVylEmF3.js";import"./popover-CI77UgAE.js";import"./globe-C44rbEdp.js";import"./utils-km2FGkQ4.js";import"./useQuery-CUE0UVvY.js";const _=()=>{const r=v();return E({mutationFn:a=>F.createApplication(a),onSuccess:()=>{r.invalidateQueries({queryKey:w.all})}})},D=r=>{const a=v();return E({mutationFn:i=>F.updateApplication(r,i),onSuccess:()=>{a.invalidateQueries({queryKey:w.all})}})},ee=u.object({name:u.string().min(1,"Application name is required"),description:u.string().min(1,"Description is required")});function N({onSubmit:r,loading:a=!1,mode:i="create",initialData:c}){const o=H({resolver:$(ee),defaultValues:{name:(c==null?void 0:c.name)||"",description:(c==null?void 0:c.description)||""}}),d=s=>{if(i==="create"){const l={name:s.name,description:s.description};r(l)}else{const l={name:s.name,description:s.description};r(l)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5 text-[#4A36EC]"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:i==="create"?"Application Information":"Update Application"})]}),e.jsx(L,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(d),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(f,{control:o.control,name:"name",render:({field:s})=>e.jsxs(j,{children:[e.jsx(y,{className:"text-gray-700",children:"Application Name *"}),e.jsx(b,{children:e.jsx(V,{...s,placeholder:"Enter application name",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",disabled:a})}),e.jsx(C,{className:"text-red-500"})]})}),e.jsx(f,{control:o.control,name:"description",render:({field:s})=>e.jsxs(j,{children:[e.jsx(y,{className:"text-gray-700",children:"Description *"}),e.jsx(b,{children:e.jsx(X,{...s,placeholder:"Enter application description",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",disabled:a,rows:4})}),e.jsx(C,{className:"text-red-500"})]})})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs(x,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",disabled:a,children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),a?i==="create"?"Creating...":"Updating...":i==="create"?"Create Application":"Update Application"]})})]})})]})}const Fe=()=>{var h;const{data:r,isLoading:a}=R(),i=m.useMemo(()=>(r==null?void 0:r.data)||[],[r==null?void 0:r.data]),c=m.useMemo(()=>[{header:"Serial",accessorKey:"serial",cell:({row:t})=>e.jsx("span",{className:"text-gray-600",children:t.index+1})},{header:"Name",accessorKey:"name"},{header:"Description",accessorKey:"description"},{header:"Status",accessorKey:"status",cell:({row:t})=>{const n=t.original.status===1;return e.jsxs("span",{className:g("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",n?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:[e.jsx("span",{className:g("w-1.5 h-1.5 rounded-full mr-1.5",n?"bg-green-400":"bg-red-400")}),n?"Active":"Inactive"]})}},{header:"Actions",id:"actions",accessorKey:"actions",cell:({row:t})=>{const n=t.original;return e.jsx(x,{size:"sm",variant:"outline",className:"hover:bg-[#4A36EC] hover:text-white hover:cursor-pointer",onClick:()=>I(n),children:"Update"})}}],[]),o=Q(),d=_(),[s,l]=m.useState(null),S=D(((h=s==null?void 0:s.id)==null?void 0:h.toString())||""),U=async t=>{try{await d.mutateAsync(t),p.success(`${t.name} created successfully`),o.close()}catch(n){console.error("Error creating application:",n),p.error("Failed to create application. Please try again.")}},P=async t=>{if(console.log("selectedApplication",s),!!s)try{console.log("applicationData",t),await S.mutateAsync(t),p.success(`${s.name} updated successfully`),o.close(),l(null)}catch(n){console.error("Error updating application:",n),p.error("Failed to update application. Please try again.")}},I=t=>{l(t),o.openForm({title:"Update Application",size:"lg",showFooter:!1,children:e.jsx(N,{onSubmit:P,mode:"update",initialData:t})})},M=()=>{o.openForm({title:"Create New Application",size:"lg",showFooter:!1,children:e.jsx(N,{onSubmit:t=>U(t)})})},q=[{title:"Total Applications",value:i.length,Icon:J,description:"Total applications received",trend:"+3.2%",trendUp:!0},{title:"Pending Applications",value:0,Icon:O,description:"Applications pending review",trend:"+2.1%",trendUp:!0},{title:"Approved Applications",value:i.filter(t=>t.status===1).length,Icon:W,description:"Applications approved",trend:"+5.4%",trendUp:!0},{title:"Rejected Applications",value:0,Icon:Y,description:"Applications rejected",trend:"-1.2%",trendUp:!1}];return e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsx(B,{items:T.threeTier("Access Control","/access-control","Applications")}),e.jsx(k,{title:"Applications",description:"Manage system applications and access requests",actions:e.jsxs(x,{onClick:M,className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Add Application"]})}),e.jsx(G,{cards:q}),e.jsx(K.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:e.jsx(z,{data:i,columns:c,loading:a,tableStyle:"border rounded-lg bg-white",tableHeadClassName:"text-[#4A36EC] font-semibold"})})]})};export{Fe as default};
