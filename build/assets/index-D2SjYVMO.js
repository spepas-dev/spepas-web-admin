import{r as x,j as e,B as v,a as b,U as P,n as C,m as N}from"./index-Bs-wGMdE.js";import{C as _,a as z}from"./card-BbF8MIz4.js";import{s as V,o as U,a as J,b as A,n as E}from"./index-DahEJCz4.js";import{u as I,G as T,M as k,I as G}from"./esm-BUVVGlHE.js";import{u as H,a as L,F as O,b as w,c as S,d as D,e as R,f as M}from"./form-B2FrkITU.js";import{D as K,a as X,b as Y,c as q,d as W}from"./dialog-CrFE0KFo.js";import{I as Z}from"./input-CJbjcwmh.js";import{M as Q}from"./multi-select-0q14WUfV.js";import{T as ee}from"./trash-2-DtvTXTfP.js";import{P as F}from"./plus-tBYduZPx.js";import{B as se}from"./badge-BMVNfdGJ.js";import{T as ae,a as re,b as y,c as f,d as le,e as j}from"./table-Cbl8yr_z.js";import{M as $}from"./map-pin-DGxtQ6VI.js";import{I as te}from"./id-card-ABACWC6l.js";import"./x-vPXFMVln.js";import"./popover-v_vaRe_g.js";import"./wand-sparkles-3x7cd1KD.js";const ie=U({licenseNumber:A().min(1,"License number is required").regex(/^[A-Z]{2}-\d{6}-\d{2}$/,"License number format should be XX-123456-YY"),longitude:E(),latitude:E(),User_ID:A().min(1,"Please select a user")}),ne=U({riders:J(ie).min(1,"Add at least one rider")}),oe=[{value:"8c66228b-9527-490b-a174-b15cb557100b",label:"John Rider",icon:v},{value:"9c66228b-9527-490b-a174-b15cb557100c",label:"Jane Rider",icon:v}],de=["places"];function ce({open:n,onOpenChange:o,onSubmit:a,selectedLocation:s}){const{isLoaded:c,loadError:d}=I({googleMapsApiKey:"",libraries:de}),r=x.useMemo(()=>({lat:5.6037,lng:-.187}),[]),l=H({resolver:V(ne),defaultValues:{riders:[{licenseNumber:"",longitude:(s==null?void 0:s.lng)||r.lng,latitude:(s==null?void 0:s.lat)||r.lat,User_ID:""}]}}),{fields:i,append:h,remove:t}=L({control:l.control,name:"riders"});x.useEffect(()=>{n||l.reset({riders:[{licenseNumber:"",longitude:(s==null?void 0:s.lng)||r.lng,latitude:(s==null?void 0:s.lat)||r.lat,User_ID:""}]})},[n,s,r]);const u=g=>{a(g.riders),l.reset()};return d?e.jsx("div",{children:"Error loading map"}):c?e.jsx(K,{open:n,onOpenChange:o,children:e.jsxs(X,{className:"max-w-2xl bg-white",children:[e.jsxs(Y,{children:[e.jsx(q,{className:"text-[#4A36EC] text-xl font-bold",children:"Add Rider"}),e.jsx(W,{className:"text-gray-600",children:"Register new delivery riders and their locations"})]}),e.jsx(O,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(u),className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:i.map((g,p)=>e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg",children:[e.jsx(w,{control:l.control,name:`riders.${p}.User_ID`,render:({field:m})=>e.jsxs(S,{children:[e.jsx(D,{className:"text-gray-700",children:"Select User"}),e.jsx(R,{children:e.jsx(Q,{options:oe,value:[m.value],onValueChange:B=>m.onChange(B[0]),placeholder:"Select a user",maxCount:1})}),e.jsx(M,{className:"text-red-500"})]})}),e.jsx(w,{control:l.control,name:`riders.${p}.licenseNumber`,render:({field:m})=>e.jsxs(S,{children:[e.jsx(D,{className:"text-gray-700",children:"License Number"}),e.jsx(R,{children:e.jsx(Z,{placeholder:"GA-123456-24",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",...m})}),e.jsx(M,{className:"text-red-500"})]})}),e.jsx("div",{className:"h-[200px] rounded-lg overflow-hidden",children:e.jsx(T,{zoom:13,center:r,mapContainerClassName:"w-full h-full",onClick:m=>{m.latLng&&(l.setValue(`riders.${p}.latitude`,m.latLng.lat()),l.setValue(`riders.${p}.longitude`,m.latLng.lng()))},children:e.jsx(k,{position:{lat:g.latitude,lng:g.longitude}})})}),i.length>1&&e.jsx(b,{type:"button",variant:"outline",size:"icon",className:"hover:bg-gray-100",onClick:()=>t(p),children:e.jsx(ee,{className:"w-4 h-4 text-gray-600"})})]},g.id))}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(b,{type:"button",variant:"outline",className:"hover:bg-gray-100",onClick:()=>h({licenseNumber:"",longitude:r.lng,latitude:r.lat,User_ID:""}),children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Add Another"]}),e.jsx(b,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:"Save Riders"})]})]})})]})}):e.jsx("div",{children:"Loading..."})}const me=["places"];function xe({riders:n,selectedLocation:o,onLocationSelect:a}){const{isLoaded:s,loadError:c}=I({googleMapsApiKey:"",libraries:me}),[d,r]=x.useState(null),l=x.useMemo(()=>o||{lat:5.6037,lng:-.187},[o]);return c?e.jsx("div",{className:"h-full flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"text-red-600",children:"Error loading map. Please check your API key."})}):s?e.jsxs(T,{zoom:13,center:l,mapContainerClassName:"w-full h-full",onClick:i=>{i.latLng&&a({lat:i.latLng.lat(),lng:i.latLng.lng()})},children:[n.map((i,h)=>e.jsx(k,{position:{lat:i.latitude,lng:i.longitude},onClick:()=>r(i)},h)),d&&e.jsx(G,{position:{lat:d.latitude,lng:d.longitude},onCloseClick:()=>r(null),children:e.jsxs("div",{className:"p-2",children:[e.jsxs("h3",{className:"font-medium text-gray-900",children:["License: ",d.licenseNumber]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ID: ",d.User_ID]})]})})]}):e.jsx("div",{className:"h-full flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"text-gray-600",children:"Loading map..."})})}const he={"8c66228b-9527-490b-a174-b15cb557100b":{name:"John Rider",email:"john@example.com"},"9c66228b-9527-490b-a174-b15cb557100c":{name:"Jane Rider",email:"jane@example.com"}};function ue({riders:n,onLocationSelect:o}){return e.jsx("div",{className:"border rounded-lg bg-white",children:e.jsxs(ae,{children:[e.jsx(re,{children:e.jsxs(y,{className:"bg-gray-50",children:[e.jsx(f,{className:"text-[#4A36EC] font-semibold",children:"License Number"}),e.jsx(f,{className:"text-[#4A36EC] font-semibold",children:"Rider Name"}),e.jsx(f,{className:"text-[#4A36EC] font-semibold",children:"Location"}),e.jsx(f,{className:"text-[#4A36EC] font-semibold",children:"Actions"})]})}),e.jsxs(le,{children:[n.map((a,s)=>{var c;return e.jsxs(y,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(j,{className:"text-gray-700 font-medium",children:a.licenseNumber}),e.jsx(j,{className:"text-gray-700",children:((c=he[a.User_ID])==null?void 0:c.name)||"Unknown User"}),e.jsx(j,{className:"text-gray-700",children:e.jsx(se,{variant:"secondary",children:`${a.latitude.toFixed(4)}, ${a.longitude.toFixed(4)}`})}),e.jsx(j,{children:e.jsxs(b,{variant:"outline",size:"sm",className:"hover:bg-[#4A36EC]/10",onClick:()=>o({lat:a.latitude,lng:a.longitude}),children:[e.jsx($,{className:"w-4 h-4 mr-2 text-[#4A36EC]"}),"View on Map"]})})]},s)}),n.length===0&&e.jsx(y,{children:e.jsx(j,{colSpan:4,className:"text-center text-gray-500 py-8",children:"No riders added yet"})})]})]})})}function Ie(){const[n,o]=x.useState(!1),[a,s]=x.useState([]),[c,d]=x.useState(null),[r,l]=x.useState(null),i=async t=>{try{console.log(t),s([...a,...t]),o(!1),l(null)}catch(u){l("Failed to add riders"),console.error(u)}},h=[{title:"Total Riders",value:a.length,icon:v,description:"Registered riders",trend:"+2.8%",trendUp:!0},{title:"Active Locations",value:a.length,icon:$,description:"Service areas",trend:"+1.9%",trendUp:!0},{title:"License Types",value:new Set(a.map(t=>t.licenseNumber.split("-")[0])).size,icon:te,description:"Different categories",trend:"+3.1%",trendUp:!0},{title:"Service Areas",value:"8",icon:P,description:"Coverage zones",trend:"+2.4%",trendUp:!0}];return e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx("a",{href:"/",className:"hover:text-[#4A36EC]",children:"Dashboard"}),e.jsx(C,{className:"w-4 h-4 mx-2"}),e.jsx("a",{href:"/user-management",className:"hover:text-[#4A36EC]",children:"User Management"}),e.jsx(C,{className:"w-4 h-4 mx-2"}),e.jsx("span",{className:"text-[#4A36EC] font-medium",children:"Riders"})]}),e.jsxs(N.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-[#4A36EC]",children:"Delivery Riders"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage delivery riders and their locations"})]}),e.jsxs(b,{onClick:()=>o(!0),className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Add Rider"]})]}),e.jsx(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:h.map((t,u)=>e.jsx(_,{className:"border border-gray-200 hover:border-[#4A36EC] transition-colors",children:e.jsxs(z,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:t.title}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mt-2",children:t.value})]}),e.jsx("div",{className:"bg-[#4A36EC]/10 p-2 rounded-lg",children:e.jsx(t.icon,{className:"w-5 h-5 text-[#4A36EC]"})})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx("p",{className:"text-xs text-gray-500",children:t.description}),e.jsx("span",{className:`text-xs font-medium ${t.trendUp?"text-green-600":"text-red-600"}`,children:t.trend})]})]})},u))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-6 gap-6",children:[e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"lg:col-span-2 h-[400px] rounded-lg overflow-hidden border",children:e.jsx(xe,{riders:a,selectedLocation:c,onLocationSelect:d})}),e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"lg:col-span-4",children:e.jsx(ue,{riders:a,onLocationSelect:d})})]}),r&&e.jsx("div",{className:"text-red-600 text-sm",children:r}),e.jsx(ce,{open:n,onOpenChange:o,onSubmit:i,selectedLocation:c})]})}export{Ie as default};
