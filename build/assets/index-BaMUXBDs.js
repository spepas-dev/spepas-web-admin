import{r as p,g as A,j as e,F as M,i as u,k as m,l as g,n as x,I as v,o as h,e as y,p as j,q as C,O as F,s as N,v as S,w,C as _,U as E,M as I,S as T,m as P,D as L,x as b}from"./index-BEfPUQd3.js";import{u as U}from"./modal-helpers-u5ghZSiS.js";import{u as D,a as K}from"./group.mutations-D6XJwe7_.js";import{s as B}from"./zod-DPUoip6C.js";import{o as H,a as k,s as f}from"./index-3Gi9B8Cu.js";import{M as V}from"./multi-select-DEp3z63F.js";import{u as q}from"./applications.queries-B_YvO4f9.js";import{L as O}from"./loader-circle-DSPkz6nm.js";import{P as z}from"./plus-D6nxsE-o.js";import{F as R}from"./folder-tree-DSE_taYH.js";import"./dialog-DfEuW_jS.js";import"./useMutation-CxnX3va-.js";import"./separator-DpEqoi9c.js";import"./circle-x-Bb9PP882.js";const $=H({title:f().min(1,"Group name is required"),group_applications:k(f()).min(1,"Select at least one application")});function J({onSubmit:i,loading:r=!1}){const{data:a}=q(),c=p.useMemo(()=>(a==null?void 0:a.data.map(s=>({label:s.name,value:s.application_id})))||[],[a==null?void 0:a.data]);console.log("applicationsData",c);const t=A({resolver:B($),defaultValues:{title:"",group_applications:[]}}),l=s=>{i({title:s.title,group_applications:s.group_applications.map(d=>({application_id:d}))}),t.reset()};return e.jsx(M,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(l),className:"space-y-6",children:[e.jsx(u,{control:t.control,name:"title",render:({field:s})=>e.jsxs(m,{children:[e.jsx(g,{children:"Group Name"}),e.jsx(x,{children:e.jsx(v,{...s,placeholder:"Enter group name"})}),e.jsx(h,{})]})}),e.jsx(u,{control:t.control,name:"group_applications",render:({field:s})=>e.jsxs(m,{children:[e.jsx(g,{children:"Applications"}),e.jsx(x,{children:e.jsx(V,{options:c,onValueChange:s.onChange,value:s.value,placeholder:"Select applications"})}),e.jsx(h,{})]})}),e.jsx("div",{className:"flex justify-end space-x-2",children:e.jsx(y,{type:"submit",className:"bg-[#4A36EC] text-white",disabled:r,children:r?e.jsx(O,{className:"w-4 h-4 mr-2 animate-spin"}):"Create Group"})})]})})}function le(){const i=U(),{data:r,isLoading:a}=D(),c=p.useMemo(()=>(r==null?void 0:r.data)||[],[r==null?void 0:r.data]),t=p.useMemo(()=>[{header:"Group Name",accessorKey:"title"},{header:"Description",accessorKey:"description"},{header:"Status",accessorKey:"status",cell:({row:o})=>{const n=o.original.status===1;return e.jsxs("span",{className:j("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",n?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:[e.jsx("span",{className:j("w-1.5 h-1.5 rounded-full mr-1.5",n?"bg-green-400":"bg-red-400")}),n?"Active":"Inactive"]})}},{header:"Created On",accessorKey:"date_added",cell:({row:o})=>e.jsx("span",{children:C(o.original.date_added,"yyyy/MM/dd HH:mm:ss a")})},{header:"Actions",accessorKey:"actions",cell:({row:o})=>e.jsx(F,{to:`/access-management/groups/${o.original.group_id}`,children:"View"})}],[]),l=K(),s=async o=>{try{await l.mutateAsync(o),b.success("Group created successfully"),i.close()}catch(n){console.error("Error creating group:",n),b.error("Failed to create group. Please try again.")}},d=()=>{i.openForm({title:"Create New Group",size:"md",showFooter:!1,children:e.jsx(J,{onSubmit:s})})},G=[{title:"Total Groups",value:0,Icon:E,description:"Active groups",trend:"+2.5%",trendUp:!0},{title:"Menu Access",value:0,Icon:I,description:"Assigned menus",trend:"+1.8%",trendUp:!0},{title:"Permissions",value:0,Icon:T,description:"Total permissions",trend:"+3.2%",trendUp:!0},{title:"Menu Groups",value:0,Icon:R,description:"Assigned groups",trend:"+1.5%",trendUp:!0}];return e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsx(N,{items:S.threeTier("Access Management","/access-management","Groups")}),e.jsx(w,{title:"Groups",description:"Manage user groups and their access rights",actions:e.jsxs(y,{onClick:d,className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Add Group"]})}),e.jsx(_,{cards:G}),e.jsx(P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:e.jsx(L,{data:c,columns:t,loading:a,tableStyle:"border rounded-lg bg-white",tableHeadClassName:"text-[#4A36EC] font-semibold"})})]})}export{le as default};
