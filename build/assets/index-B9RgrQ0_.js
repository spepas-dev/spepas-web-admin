import{A as i,i as L,k as I,j as e,S as x,U as A,a as b,r as p,l as M,n as R,m as S}from"./index-Cx3yMQ3f.js";import{D as P}from"./index-D0svd0GM.js";import{C as U}from"./card-grid-C7Gl_Uh6.js";import{u as $,a as _,F as k,b as h,c as j,d as g,e as y,f}from"./form-DABIbnA-.js";import{u as q}from"./useMutation-DdnS_ohS.js";import{u as B}from"./useQuery-Ly3xzLnF.js";import{s as O,o as w,a as E,b as v}from"./index-CJEG_s-O.js";import{D as G,a as K,b as Q,c as V,d as J}from"./dialog-OWjewGbD.js";import{I as H}from"./input-BY_FTDhY.js";import{M as D}from"./multi-select-PHxOC5fO.js";import{T as z}from"./textarea-CLf_UvS5.js";import{T as W}from"./trash-2-78zht_3s.js";import{P as T}from"./plus-BarkCOgP.js";import{C as X}from"./circle-user-CFQ6mG4W.js";import{L as Y}from"./lock-avjGx2IR.js";import"./table-CbxoolaY.js";import"./sliders-horizontal-CPYaJ2M2.js";import"./x-45uRG9y6.js";import"./select-5_mZnO0V.js";import"./arrow-left-CEUZlc21.js";import"./arrow-right-DHaoxvRn.js";import"./card-BtOxIeoK.js";import"./popover-CAKtuJnK.js";import"./globe-CgBe-rT5.js";import"./badge-BQaAw9nc.js";import"./wand-sparkles-DkqZMXu_.js";const c=L.ACCESS_MANAGEMENT.ROLE;class F{static async getRole(s){return i.get(c.DETAIL(s))}static async createRole(s){return i.post(c.CREATE,s)}static async updateRole(s,n){return i.put(`${c}/${s}`,n)}static async deleteRole(s){return i.delete(`${c}/${s}`)}static async getRoleList(s){return i.get(c.BASE,{params:s})}static async getRoleStats(s){return i.get(`${c}/${s}/stats`)}}const d={all:["role"],list:()=>[...d.all,"list"],details:t=>[...d.all,"details",t],stats:t=>[...d.all,"stats",t]},Z=()=>B({queryKey:d.list(),queryFn:()=>F.getRoleList()}),ee=()=>{const t=I();return q({mutationFn:s=>F.createRole(s),onSuccess:()=>{t.invalidateQueries({queryKey:d.all})}})},se=w({name:v().min(1,"Role name is required"),description:v().min(10,"Description must be at least 10 characters"),permissions:E(v()).min(1,"Select at least one permission"),users:E(v())}),ae=w({roles:E(se).min(1,"Add at least one role")}),re=[{value:"view_dashboard",label:"View Dashboard",icon:x},{value:"manage_users",label:"Manage Users",icon:x},{value:"manage_inventory",label:"Manage Inventory",icon:x},{value:"generate_reports",label:"Generate Reports",icon:x}],te=[{value:"user1",label:"John Doe",icon:A},{value:"user2",label:"Jane Smith",icon:A},{value:"user3",label:"Bob Johnson",icon:A}];function oe({open:t,onOpenChange:s,onSubmit:n}){const a=$({resolver:O(ae),defaultValues:{roles:[{name:"",description:"",permissions:[],users:[]}]}}),{fields:o,append:N,remove:u}=_({control:a.control,name:"roles"}),C=m=>{n(m.roles),a.reset()};return e.jsx(G,{open:t,onOpenChange:s,children:e.jsxs(K,{className:"max-w-2xl bg-white",children:[e.jsxs(Q,{children:[e.jsx(V,{className:"text-[#4A36EC] text-xl font-bold",children:"Add Roles"}),e.jsx(J,{className:"text-gray-600",children:"Create new roles and assign permissions"})]}),e.jsx(k,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(C),className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:o.map((m,l)=>e.jsxs("div",{className:"flex gap-4 items-start",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsx(h,{control:a.control,name:`roles.${l}.name`,render:({field:r})=>e.jsxs(j,{children:[e.jsx(g,{className:"text-gray-700",children:"Role Name"}),e.jsx(y,{children:e.jsx(H,{placeholder:"Enter role name",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",...r})}),e.jsx(f,{className:"text-red-500"})]})}),e.jsx(h,{control:a.control,name:`roles.${l}.description`,render:({field:r})=>e.jsxs(j,{children:[e.jsx(g,{className:"text-gray-700",children:"Description"}),e.jsx(y,{children:e.jsx(z,{placeholder:"Enter role description",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",...r})}),e.jsx(f,{className:"text-red-500"})]})}),e.jsx(h,{control:a.control,name:`roles.${l}.permissions`,render:({field:r})=>e.jsxs(j,{children:[e.jsx(g,{className:"text-gray-700",children:"Permissions"}),e.jsx(y,{children:e.jsx(D,{options:re,value:r.value,onValueChange:r.onChange,placeholder:"Select permissions",maxCount:2,animation:.3,variant:"secondary",modalPopover:!0})}),e.jsx(f,{className:"text-red-500"})]})}),e.jsx(h,{control:a.control,name:`roles.${l}.users`,render:({field:r})=>e.jsxs(j,{children:[e.jsx(g,{className:"text-gray-700",children:"Assign Users"}),e.jsx(y,{children:e.jsx(D,{options:te,value:r.value,onValueChange:r.onChange,placeholder:"Select users",maxCount:3,animation:.3,variant:"default",modalPopover:!0})}),e.jsx(f,{className:"text-red-500"})]})})]}),o.length>1&&e.jsx(b,{type:"button",variant:"outline",size:"icon",className:"mt-8 hover:bg-gray-100",onClick:()=>u(l),children:e.jsx(W,{className:"w-4 h-4 text-gray-600"})})]},m.id))}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(b,{type:"button",variant:"outline",className:"hover:bg-gray-100",onClick:()=>N({name:"",description:"",permissions:[],users:[]}),children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Add Another"]}),e.jsx(b,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:"Save Roles"})]})]})})]})})}function Le(){const[t,s]=p.useState(!1),[n,a]=p.useState([]),{data:o,isError:N,isLoading:u}=Z();p.useEffect(()=>(o&&a(o.data),()=>{a([])}),[o==null?void 0:o.data]);const C=p.useMemo(()=>[{header:"Role Name",accessorKey:"name"}],[]);ee();const m=async r=>{console.log(r),s(!1)},l=[{title:"Total Roles",value:n.length,Icon:X,description:"Active roles in system",trend:"+2.1%",trendUp:!0},{title:"Access Levels",value:5,Icon:Y,description:"Security levels",trend:"+0.9%",trendUp:!0}];return u?e.jsx("div",{className:"p-8 space-y-8",children:e.jsx(M,{})}):N?e.jsx("div",{children:"Error loading roles"}):e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx("a",{href:"/",className:"hover:text-[#4A36EC]",children:"Dashboard"}),e.jsx(R,{className:"w-4 h-4 mx-2"}),e.jsx("a",{href:"/access-control",className:"hover:text-[#4A36EC]",children:"Access Control"}),e.jsx(R,{className:"w-4 h-4 mx-2"}),e.jsx("span",{className:"text-[#4A36EC] font-medium",children:"Roles"})]}),e.jsxs(S.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-[#4A36EC]",children:"Roles"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage user roles and their permissions"})]}),e.jsxs(b,{onClick:()=>s(!0),className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Add Role"]})]}),e.jsx(U,{cards:l}),e.jsx(S.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:e.jsx(P,{data:n,columns:C,loading:u,tableStyle:"border rounded-lg bg-white",tableHeadClassName:"text-[#4A36EC] font-semibold"})}),e.jsx(oe,{open:t,onOpenChange:s,onSubmit:m})]})}export{Le as default};
