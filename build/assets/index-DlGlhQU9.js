import{r as x,j as e,z as S,a as f,U as $,n as C,m as N}from"./index-CG3cDFil.js";import{C as B,a as z}from"./card-TUnhNMrf.js";import{s as R,o as M,a as V,b as y,n as A}from"./index-Cksdco4c.js";import{u as T,G as k,M as F,I as J}from"./esm-CrBfFAW1.js";import{u as H,a as O,F as K,b as E,c as D,d as w,e as I,f as G}from"./form-_i_eYalU.js";import{D as q,a as W,b as Q,c as X,d as Y}from"./dialog-V-TE0CwV.js";import{I as Z}from"./input-0St3XTHq.js";import{M as L}from"./multi-select-CynJAMoS.js";import{T as ee}from"./trash-2-X-Fq5KTG.js";import{P as U}from"./plus-CgI7Ta1y.js";import{B as se}from"./badge-CWZmtTXQ.js";import{T as ae,a as le,b as v,c as b,d as te,e as j}from"./table-CXQMyFfb.js";import{M as _}from"./map-pin-DdQqKxnr.js";import{S as re}from"./shopping-bag-D1oZlMti.js";import"./x-BgpYH4Yb.js";import"./popover-P3KGh40z.js";import"./wand-sparkles-C-ss3xfk.js";const ne=M({storeName:y().min(1,"Store name is required"),longitude:A(),latitude:A(),Gopa_ID:y().min(1,"Please select a Gopo"),User_ID:y().min(1,"Please select a user")}),ie=M({sellers:V(ne).min(1,"Add at least one seller store")}),oe=[{value:"528008c6-d9fd-4590-ad84-6b9a42b84197",label:"John Doe",icon:S},{value:"628008c6-d9fd-4590-ad84-6b9a42b84198",label:"Jane Smith",icon:S}],de=["places"];function ce({open:i,onOpenChange:o,onSubmit:a,selectedLocation:s}){const{isLoaded:c,loadError:d}=T({googleMapsApiKey:"",libraries:de}),l=x.useMemo(()=>({lat:5.6037,lng:-.187}),[]),t=H({resolver:R(ie),defaultValues:{sellers:[{storeName:"",longitude:(s==null?void 0:s.lng)||l.lng,latitude:(s==null?void 0:s.lat)||l.lat,Gopa_ID:"",User_ID:""}]}}),{fields:n,append:h,remove:r}=O({control:t.control,name:"sellers"});x.useEffect(()=>{i||t.reset({sellers:[{storeName:"",longitude:(s==null?void 0:s.lng)||l.lng,latitude:(s==null?void 0:s.lat)||l.lat,Gopa_ID:"",User_ID:""}]})},[i,s,l]);const g=p=>{a(p.sellers),t.reset()};return d?e.jsx("div",{children:"Error loading map"}):c?e.jsx(q,{open:i,onOpenChange:o,children:e.jsxs(W,{className:"max-w-2xl bg-white",children:[e.jsxs(Q,{children:[e.jsx(X,{className:"text-[#4A36EC] text-xl font-bold",children:"Add Seller Store"}),e.jsx(Y,{className:"text-gray-600",children:"Register new seller stores and their locations"})]}),e.jsx(K,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(g),className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:n.map((p,u)=>e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg",children:[e.jsx(E,{control:t.control,name:`sellers.${u}.Gopa_ID`,render:({field:m})=>e.jsxs(D,{children:[e.jsx(w,{className:"text-gray-700",children:"Select Gopo"}),e.jsx(I,{children:e.jsx(L,{options:oe,value:[m.value],onValueChange:P=>m.onChange(P[0]),placeholder:"Select a Gopo",maxCount:1})}),e.jsx(G,{className:"text-red-500"})]})}),e.jsx(E,{control:t.control,name:`sellers.${u}.storeName`,render:({field:m})=>e.jsxs(D,{children:[e.jsx(w,{className:"text-gray-700",children:"Store Name"}),e.jsx(I,{children:e.jsx(Z,{placeholder:"Enter store name",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",...m})}),e.jsx(G,{className:"text-red-500"})]})}),e.jsx("div",{className:"h-[200px] rounded-lg overflow-hidden",children:e.jsx(k,{zoom:13,center:l,mapContainerClassName:"w-full h-full",onClick:m=>{m.latLng&&(t.setValue(`sellers.${u}.latitude`,m.latLng.lat()),t.setValue(`sellers.${u}.longitude`,m.latLng.lng()))},children:e.jsx(F,{position:{lat:p.latitude,lng:p.longitude}})})}),n.length>1&&e.jsx(f,{type:"button",variant:"outline",size:"icon",className:"hover:bg-gray-100",onClick:()=>r(u),children:e.jsx(ee,{className:"w-4 h-4 text-gray-600"})})]},p.id))}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(f,{type:"button",variant:"outline",className:"hover:bg-gray-100",onClick:()=>h({storeName:"",longitude:l.lng,latitude:l.lat,Gopa_ID:"",User_ID:""}),children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Add Another"]}),e.jsx(f,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:"Save Stores"})]})]})})]})}):e.jsx("div",{children:"Loading..."})}const me=["places"];function xe({sellers:i,selectedLocation:o,onLocationSelect:a}){const{isLoaded:s,loadError:c}=T({googleMapsApiKey:"",libraries:me}),[d,l]=x.useState(null),t=x.useMemo(()=>o||{lat:5.6037,lng:-.187},[o]);return c?e.jsx("div",{className:"h-full flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"text-red-600",children:"Error loading map. Please check your API key."})}):s?e.jsxs(k,{zoom:13,center:t,mapContainerClassName:"w-full h-full",onClick:n=>{n.latLng&&a({lat:n.latLng.lat(),lng:n.latLng.lng()})},children:[i.map((n,h)=>e.jsx(F,{position:{lat:n.latitude,lng:n.longitude},onClick:()=>l(n)},h)),d&&e.jsx(J,{position:{lat:d.latitude,lng:d.longitude},onCloseClick:()=>l(null),children:e.jsxs("div",{className:"p-2",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:d.storeName}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Gopo ID: ",d.Gopa_ID]})]})})]}):e.jsx("div",{className:"h-full flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"text-gray-600",children:"Loading map..."})})}const he={"528008c6-d9fd-4590-ad84-6b9a42b84197":{name:"John Doe",email:"john@example.com"},"628008c6-d9fd-4590-ad84-6b9a42b84198":{name:"Jane Smith",email:"jane@example.com"}};function ge({sellers:i,onLocationSelect:o}){return e.jsx("div",{className:"border rounded-lg bg-white",children:e.jsxs(ae,{children:[e.jsx(le,{children:e.jsxs(v,{className:"bg-gray-50",children:[e.jsx(b,{className:"text-[#4A36EC] font-semibold",children:"Store Name"}),e.jsx(b,{className:"text-[#4A36EC] font-semibold",children:"Assigned Gopo"}),e.jsx(b,{className:"text-[#4A36EC] font-semibold",children:"Location"}),e.jsx(b,{className:"text-[#4A36EC] font-semibold",children:"Actions"})]})}),e.jsxs(te,{children:[i.map((a,s)=>{var c;return e.jsxs(v,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(j,{className:"text-gray-700 font-medium",children:a.storeName}),e.jsx(j,{className:"text-gray-700",children:((c=he[a.Gopa_ID])==null?void 0:c.name)||"Unknown Gopo"}),e.jsx(j,{className:"text-gray-700",children:e.jsx(se,{variant:"secondary",children:`${a.latitude.toFixed(4)}, ${a.longitude.toFixed(4)}`})}),e.jsx(j,{children:e.jsxs(f,{variant:"outline",size:"sm",className:"hover:bg-[#4A36EC]/10",onClick:()=>o({lat:a.latitude,lng:a.longitude}),children:[e.jsx(_,{className:"w-4 h-4 mr-2 text-[#4A36EC]"}),"View on Map"]})})]},s)}),i.length===0&&e.jsx(v,{children:e.jsx(j,{colSpan:4,className:"text-center text-gray-500 py-8",children:"No seller stores added yet"})})]})]})})}function Te(){const[i,o]=x.useState(!1),[a,s]=x.useState([]),[c,d]=x.useState(null),[l,t]=x.useState(null),n=async r=>{try{console.log(r),s([...a,...r]),o(!1),t(null)}catch(g){t("Failed to add sellers"),console.error(g)}},h=[{title:"Total Sellers",value:a.length,icon:S,description:"Registered sellers",trend:"+3.2%",trendUp:!0},{title:"Active Locations",value:a.length,icon:_,description:"Service locations",trend:"+2.1%",trendUp:!0},{title:"Assigned Gopos",value:new Set(a.map(r=>r.Gopa_ID)).size,icon:$,description:"Active Gopos",trend:"+1.5%",trendUp:!0},{title:"Total Products",value:"156",icon:re,description:"Listed products",trend:"+4.3%",trendUp:!0}];return e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx("a",{href:"/",className:"hover:text-[#4A36EC]",children:"Dashboard"}),e.jsx(C,{className:"w-4 h-4 mx-2"}),e.jsx("a",{href:"/user-management",className:"hover:text-[#4A36EC]",children:"User Management"}),e.jsx(C,{className:"w-4 h-4 mx-2"}),e.jsx("span",{className:"text-[#4A36EC] font-medium",children:"Sellers"})]}),e.jsxs(N.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-[#4A36EC]",children:"Seller Stores"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage seller stores and their locations"})]}),e.jsxs(f,{onClick:()=>o(!0),className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Add Seller Store"]})]}),e.jsx(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:h.map((r,g)=>e.jsx(B,{className:"border border-gray-200 hover:border-[#4A36EC] transition-colors",children:e.jsxs(z,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:r.title}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mt-2",children:r.value})]}),e.jsx("div",{className:"bg-[#4A36EC]/10 p-2 rounded-lg",children:e.jsx(r.icon,{className:"w-5 h-5 text-[#4A36EC]"})})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx("p",{className:"text-xs text-gray-500",children:r.description}),e.jsx("span",{className:`text-xs font-medium ${r.trendUp?"text-green-600":"text-red-600"}`,children:r.trend})]})]})},g))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-6 gap-6",children:[e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"lg:col-span-2 h-[400px] rounded-lg overflow-hidden border",children:e.jsx(xe,{sellers:a,selectedLocation:c,onLocationSelect:d})}),e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"lg:col-span-4",children:e.jsx(ge,{sellers:a,onLocationSelect:d})})]}),l&&e.jsx("div",{className:"text-red-600 text-sm",children:l}),e.jsx(ce,{open:i,onOpenChange:o,onSubmit:n,selectedLocation:c})]})}export{Te as default};
