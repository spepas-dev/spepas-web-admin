import{e as o,A,r as g,j as e,B as x,a as S,c as b,U as E,m as I,d as f}from"./index-C2Q_LmeJ.js";import{B as D,a as U,P as C}from"./pageHeader-7vhK00zh.js";import{D as M}from"./index-CvxHYYsL.js";import{u as F}from"./modal-helpers-CaXMt30Z.js";import{C as w}from"./card-grid-CZ4tobzV.js";import{u as _,F as P,b as j,c as y,d as v,e as N,f as R}from"./form-CcMvRR1f.js";import{u as L}from"./useQuery-CUE0UVvY.js";import{s as $,z as c}from"./index-DyAPY9a1.js";import{u as B,G as T,M as K}from"./esm-TUw15Obf.js";import{I as G}from"./input-fvZZM-h7.js";import{M as k}from"./multi-select-GP_yjtwv.js";import{M as z}from"./map-pin-D3JmskLF.js";import{I as V}from"./id-card-eioc5glB.js";import{P as q}from"./plus-BFloapdy.js";import"./table-CAIVgxvw.js";import"./dialog-BxdRvcNA.js";import"./select-K8uUziWX.js";import"./arrow-left-DT7SArHl.js";import"./arrow-right-Ct_-AZHB.js";import"./card-CVylEmF3.js";import"./popover-CI77UgAE.js";import"./globe-C44rbEdp.js";import"./utils-km2FGkQ4.js";import"./badge-rX3Jh1SJ.js";import"./separator-q4J_vRT3.js";import"./circle-x-DWBwq746.js";import"./wand-sparkles-JjYTZCVz.js";const l=A.USER_MANAGEMENT.RIDER;class H{static async registerRider(s){return o.post(`${l}`,s)}static async getRider(s){return o.get(`${l.DETAIL}/${s}`)}static async updateRider(s,t){return o.put(`${l}/${s}`,t)}static async deleteRider(s){return o.delete(`${l}/${s}`)}static async getRiderStats(s){return o.get(`${l}/${s}/stats`)}static async getRiderList(s){return o.get(`${l.BASE}`,{params:s})}}const J=()=>L({queryKey:["rider-list"],queryFn:()=>H.getRiderList()}),O=c.object({licenseNumber:c.string().min(1,"License number is required"),longitude:c.number(),latitude:c.number(),User_ID:c.string().min(1,"Please select a user")}),Q=[{value:"user1",label:"John Doe",icon:x},{value:"user2",label:"Jane Smith",icon:x}],W=["places"];function X({onSubmit:n,loading:s=!1,selectedLocation:t}){const{isLoaded:u,loadError:m}=B({googleMapsApiKey:"",libraries:W}),d=g.useMemo(()=>({lat:5.6037,lng:-.187}),[]),i=_({resolver:$(O),defaultValues:{licenseNumber:"",longitude:(t==null?void 0:t.lng)||d.lng,latitude:(t==null?void 0:t.lat)||d.lat,User_ID:""}}),p=r=>{const a={licenseNumber:r.licenseNumber,User_ID:r.User_ID,location:{type:"Point",coordinates:[r.longitude,r.latitude]}};n(a),i.reset()};return m?e.jsx("div",{children:"Error loading map"}):u?e.jsx(P,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(p),className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"flex gap-4 items-start",children:e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsx(j,{control:i.control,name:"User_ID",render:({field:r})=>e.jsxs(y,{children:[e.jsx(v,{className:"text-gray-700",children:"Select User"}),e.jsx(N,{children:e.jsx(k,{options:Q,value:[r.value],onValueChange:a=>r.onChange(a[0]),placeholder:"Select a user",maxCount:1,disabled:s})}),e.jsx(R,{className:"text-red-500"})]})}),e.jsx(j,{control:i.control,name:"licenseNumber",render:({field:r})=>e.jsxs(y,{children:[e.jsx(v,{className:"text-gray-700",children:"License Number"}),e.jsx(N,{children:e.jsx(G,{placeholder:"Enter license number",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",disabled:s,...r})}),e.jsx(R,{className:"text-red-500"})]})}),e.jsx("div",{className:"h-[200px] rounded-lg overflow-hidden",children:e.jsx(T,{zoom:13,center:d,mapContainerClassName:"w-full h-full",onClick:r=>{r.latLng&&(i.setValue("latitude",r.latLng.lat()),i.setValue("longitude",r.latLng.lng()))},children:e.jsx(K,{position:{lat:i.watch("latitude"),lng:i.watch("longitude")}})})})]})})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(S,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",disabled:s,children:s?"Saving...":"Save Rider"})})]})}):e.jsx("div",{children:"Loading..."})}function Ae(){const{data:n,isLoading:s}=J(),t=g.useMemo(()=>(n==null?void 0:n.data)||[],[n==null?void 0:n.data]),u=g.useMemo(()=>[{header:"License Number",accessorKey:"licenseNumber",cell:({row:r})=>e.jsx("div",{children:r.original.licenseNumber})},{header:"User ID",accessorKey:"User_ID",cell:({row:r})=>e.jsx("div",{children:r.original.User_ID})},{header:"Location",accessorKey:"location",cell:({row:r})=>{var a,h;return e.jsxs("div",{children:[(a=r.original.location)==null?void 0:a.coordinates[1],", ",(h=r.original.location)==null?void 0:h.coordinates[0]]})}},{header:"Status",accessorKey:"status",cell:({row:r})=>{const a=r.original.status===1;return e.jsxs("span",{className:b("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",a?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:[e.jsx("span",{className:b("w-1.5 h-1.5 rounded-full mr-1.5",a?"bg-green-400":"bg-red-400")}),a?"Active":"Inactive"]})}},{header:"Date Added",accessorKey:"date_added",cell:({row:r})=>e.jsx("div",{children:new Date(r.original.date_added).toLocaleDateString()})}],[]),m=F(),d=()=>{m.openForm({title:"Add New Rider",children:e.jsx(X,{onSubmit:i,loading:!1}),showFooter:!1})},i=async r=>{try{console.log(r),f.success("Rider created successfully"),m.close()}catch{f.error("Failed to create rider")}},p=[{title:"Total Riders",value:t.length,Icon:x,description:"Registered riders",trend:"+2.8%",trendUp:!0},{title:"Active Locations",value:t.length,Icon:z,description:"Service areas",trend:"+1.9%",trendUp:!0},{title:"License Types",value:new Set(t.map(r=>{var a;return(a=r.licenseNumber)==null?void 0:a.split("-")[0]})).size,Icon:V,description:"Different categories",trend:"+3.1%",trendUp:!0},{title:"Service Areas",value:"8",Icon:E,description:"Coverage zones",trend:"+2.4%",trendUp:!0}];return e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsx(D,{items:U.threeTier("User Management","/user-management","Riders")}),e.jsx(C,{title:"Delivery Riders",description:"Manage delivery riders and their locations",actions:e.jsxs(S,{onClick:d,className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Add Rider"]})}),e.jsx(w,{cards:p}),e.jsx(I.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:e.jsx(M,{data:t,columns:u,loading:s,tableStyle:"border rounded-lg bg-white",tableHeadClassName:"text-[#4A36EC] font-semibold"})})]})}export{Ae as default};
