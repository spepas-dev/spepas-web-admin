import{c as J,z as m,y as Q,E as Y,f as Z,g as P,j as e,F as R,i as T,k as _,l as ee,H as k,n as C,J as K,K as $,L as H,N as b,o as V,e as y,r as x,aC as q,G as w,Q as se,R as ae,T as re,V as te,X as le,Z as ne,_ as ce,$ as ie,a0 as oe,p as U,I as de,W as S,q as G,bk as ue,bl as me,bm as he,bn as xe,bo as I,bp as pe,P as ye,s as je,v as ge,w as be,C as Ne,m as fe,D as Ee,x as L}from"./index-BEfPUQd3.js";import{u as B}from"./modal-helpers-u5ghZSiS.js";import{u as we}from"./useMutation-CxnX3va-.js";import{s as z}from"./zod-DPUoip6C.js";import{o as Ce,e as Se,z as D}from"./index-3Gi9B8Cu.js";import{C as ve}from"./chevrons-up-down-BEyfiSas.js";import{C as M}from"./credit-card-DOs8d0dW.js";import{P as We}from"./plus-D6nxsE-o.js";import"./dialog-DfEuW_jS.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Ie=J("Ellipsis",Ae),h=Q.WALLET_MANAGEMENT;class O{static async getWallets(a){return m.get(h.BASE,{params:a})}static async getWalletByWalletID(a){return m.get(`${h.DETAIL_BY_ID(a)}`)}static async getWalletByWalletNumber(a){return m.get(`${h.DETAIL_BY_WALLET_NUMBER(a)}`)}static async getWalletByUser(a){return m.get(`${h.DETAIL_BY_USER(a)}`)}static async createWallet(a){return m.post(h.CREATE,a)}static async updateWallet(a,l){return m.put(`${h}/${a}`,l)}static async deleteWallet(a){return m.delete(`${h}/${a}`)}}const N={all:["wallets"],detail:t=>[...N.all,"detail",t],lists:()=>[...N.all,"list"],list:t=>[...N.lists(),t]},De=t=>Y({queryKey:N.list({}),queryFn:()=>O.getWallets(t)}),Te=()=>{const t=Z();return we({mutationFn:a=>O.createWallet(a),onSuccess:()=>{t.invalidateQueries({queryKey:N.all})}})},_e=Ce({wallet_type:Se(["REVENUE","EXPENSE"],{required_error:"Please select a wallet type"})});function Ve({onSubmit:t,loading:a=!1}){const l=P({resolver:z(_e),defaultValues:{wallet_type:"REVENUE"}}),p=c=>{t(c),l.reset()};return e.jsx(R,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(p),className:"space-y-6",children:[e.jsx(T,{control:l.control,name:"wallet_type",render:({field:c})=>e.jsxs(_,{children:[e.jsx(ee,{className:"text-gray-700",children:"Wallet Type"}),e.jsxs(k,{onValueChange:c.onChange,defaultValue:c.value,disabled:a,children:[e.jsx(C,{children:e.jsx(K,{className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",children:e.jsx($,{placeholder:"Select wallet type"})})}),e.jsxs(H,{children:[e.jsx(b,{value:"REVENUE",children:"Revenue"}),e.jsx(b,{value:"EXPENSE",children:"Expense"})]})]}),e.jsx(V,{className:"text-red-500"})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(y,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",disabled:a,children:a?"Creating...":"Create Wallet"})})]})})}const Ue=[{id:"user123",name:"John Doe"},{id:"user456",name:"Jane Smith"},{id:"user789",name:"Robert Johnson"},{id:"user101",name:"Emily Davis"},{id:"user102",name:"Michael Wilson"}],Me=D.object({searchType:D.enum(["walletNumber","walletId","userId"]),searchValue:D.string().min(1,"Search value is required")});function Fe({wallets:t,loading:a=!1}){const[l,p]=x.useState([]),[c,o]=x.useState(null),[j,f]=x.useState(!1),[n,v]=x.useState(null),i=P({resolver:z(Me),defaultValues:{searchType:"walletNumber",searchValue:""}}),E=i.watch("searchType"),W=s=>{let u=[...t];s.searchType==="walletNumber"?u=u.filter(g=>g.WalletNumber.toLowerCase().includes(s.searchValue.toLowerCase())):s.searchType==="walletId"?u=u.filter(g=>g.walletID.toLowerCase().includes(s.searchValue.toLowerCase())):s.searchType==="userId"&&n&&(u=u.filter(g=>{var F;return((F=g.User_ID)==null?void 0:F.toString())===n.id})),p(u),u.length===1?o(u[0]):o(null)},A=s=>G(new Date(s),"MMM dd, yyyy"),r=s=>{switch(s){case 1:return e.jsx(w,{className:"bg-green-500",children:"Active"});case 0:return e.jsx(w,{className:"bg-red-500",children:"Inactive"});default:return e.jsx(w,{className:"bg-gray-500",children:"Unknown"})}},d=s=>{switch(s){case"REVENUE":return e.jsx(S,{className:"h-4 w-4 text-[#4A36EC]"});case"EXPENSE":return e.jsx(M,{className:"h-4 w-4 text-[#4A36EC]"});default:return e.jsx(S,{className:"h-4 w-4 text-[#4A36EC]"})}},X=()=>E==="userId"?e.jsxs(se,{open:j,onOpenChange:f,children:[e.jsx(ae,{asChild:!0,children:e.jsx(C,{children:e.jsxs(y,{variant:"outline",role:"combobox","aria-expanded":j,className:"w-full justify-between border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",disabled:a,children:[n?n.name:"Select user...",e.jsx(ve,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),e.jsx(re,{className:"w-full p-0",children:e.jsxs(te,{children:[e.jsx(le,{placeholder:"Search users..."}),e.jsx(ne,{children:"No user found."}),e.jsx(ce,{children:Ue.map(s=>e.jsxs(ie,{value:s.name,onSelect:()=>{v(s),f(!1),i.setValue("searchValue",s.id)},children:[e.jsx(oe,{className:U("mr-2 h-4 w-4",(n==null?void 0:n.id)===s.id?"opacity-100":"opacity-0")}),s.name]},s.id))})]})})]}):e.jsx(C,{children:e.jsx(de,{placeholder:E==="walletNumber"?"Enter wallet number (e.g., S000005)":"Enter wallet ID",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",disabled:a,...i.register("searchValue")})});return e.jsxs("div",{className:"space-y-6",children:[e.jsx(R,{...i,children:e.jsx("form",{onSubmit:i.handleSubmit(W),className:"space-y-4",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(T,{control:i.control,name:"searchType",render:()=>e.jsxs(_,{className:"w-[180px]",children:[e.jsxs(k,{onValueChange:s=>i.setValue("searchType",s),defaultValue:i.getValues("searchType"),disabled:a,children:[e.jsx(C,{children:e.jsx(K,{className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",children:e.jsx($,{placeholder:"Search by..."})})}),e.jsxs(H,{children:[e.jsx(b,{value:"walletNumber",children:"Wallet Number"}),e.jsx(b,{value:"walletId",children:"Wallet ID"}),e.jsx(b,{value:"userId",children:"User"})]})]}),e.jsx(V,{className:"text-red-500"})]})}),e.jsx(T,{control:i.control,name:"searchValue",render:()=>e.jsxs(_,{className:"flex-1",children:[X(),e.jsx(V,{className:"text-red-500"})]})}),e.jsxs(y,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",disabled:a,children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),a?"Searching...":"Search"]})]})})}),l.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Found ",l.length," wallet",l.length!==1?"s":""]}),l.map(s=>e.jsxs("div",{className:`p-4 border rounded-lg transition-colors cursor-pointer ${(c==null?void 0:c.id)===s.id?"border-[#4A36EC] bg-[#4A36EC]/5":"border-gray-200 hover:border-[#4A36EC]"}`,onClick:()=>o(s),children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[d(s.wallet_type),e.jsx("h3",{className:"font-medium",children:s.WalletNumber}),e.jsx(w,{variant:"outline",className:"ml-2",children:s.wallet_type})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["ID: ",s.walletID]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"GHS"}).format(s.balance)}),r(s.status)]})]}),(c==null?void 0:c.id)===s.id&&e.jsxs("div",{className:"mt-4 pt-4 border-t grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"User ID"}),e.jsx("p",{className:"text-base",children:s.User_ID||"Not assigned"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Created"}),e.jsx("p",{className:"text-base",children:A(s.date_created)})]})]})]},s.id))]}),l.length===0&&i.getValues("searchValue")&&e.jsx("div",{className:"text-center py-6",children:e.jsx("p",{className:"text-gray-500",children:"No wallets found matching your search criteria."})})]})}function Ge(){const[t,a]=x.useState(!1),l=Te(),p=B(),c=B(),{data:o,isLoading:j,isError:f}=De(),n=x.useMemo(()=>(o==null?void 0:o.data)||[],[o==null?void 0:o.data]),v=async r=>{a(!0);try{await l.mutateAsync(r),L.success("Wallet created successfully"),p.close()}catch(d){console.error("Error creating wallet:",d),L.error("Failed to create wallet. Please try again.")}finally{a(!1)}},i=()=>{p.openForm({title:"Create New Wallet",size:"sm",showFooter:!1,children:e.jsx(Ve,{onSubmit:v,loading:t})})},E=()=>{c.openForm({title:"Search Wallets",size:"md",showFooter:!1,children:e.jsx(Fe,{wallets:n,loading:!1})})},W=x.useMemo(()=>[{header:"Wallet Number",accessorKey:"WalletNumber"},{header:"Wallet Type",accessorKey:"wallet_type",cell:({row:r})=>e.jsx("span",{className:"capitalize text-gray-600",children:r.original.wallet_type.toLowerCase()})},{header:"Balance",accessorKey:"balance",cell:({row:r})=>e.jsx("span",{children:new Intl.NumberFormat("en-US",{style:"currency",currency:"GHS"}).format(r.original.balance)})},{header:"User ID",accessorKey:"User_ID",cell:({row:r})=>e.jsx("span",{className:"text-gray-600",children:r.original.User_ID||"Not assigned"})},{header:"Status",accessorKey:"status",cell:({row:r})=>{const d=r.original.status===1;return e.jsxs("span",{className:U("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",d?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:[e.jsx("span",{className:U("w-1.5 h-1.5 rounded-full mr-1.5",d?"bg-green-400":"bg-red-400")}),d?"Active":"Inactive"]})}},{header:"Created On",accessorKey:"date_created",cell:({row:r})=>e.jsx("span",{className:"text-gray-600",children:G(new Date(r.original.date_created),"yyyy/MM/dd HH:mm:a")})},{header:"Actions",id:"actions",accessorKey:"actions",cell:()=>e.jsx("div",{className:"flex justify-end",children:e.jsxs(ue,{children:[e.jsx(me,{asChild:!0,children:e.jsxs(y,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(Ie,{className:"h-4 w-4"})]})}),e.jsxs(he,{align:"end",children:[e.jsx(xe,{children:"Actions"}),e.jsx(I,{children:"View Details"}),e.jsx(I,{children:"Edit Wallet"}),e.jsx(pe,{}),e.jsx(I,{className:"text-red-600",children:"Deactivate"})]})]})})}],[]),A=[{title:"Total Wallets",value:n.length,Icon:S,description:"Active wallets in system",trend:"+3.2%",trendUp:!0},{title:"Total Balance",value:new Intl.NumberFormat("en-US",{style:"currency",currency:"GHS"}).format(n.reduce((r,d)=>r+d.balance,0)),Icon:M,description:"Combined wallet balance",trend:"+5.4%",trendUp:!0},{title:"Revenue Wallets",value:n.filter(r=>r.wallet_type==="REVENUE").length,Icon:S,description:"Wallets for revenue",trend:"+2.1%",trendUp:!0},{title:"Expense Wallets",value:n.filter(r=>r.wallet_type==="EXPENSE").length,Icon:M,description:"Wallets for expenses",trend:"+1.8%",trendUp:!0}];return j?e.jsx("div",{className:"p-8 space-y-8",children:e.jsx(ye,{})}):f?e.jsx("div",{children:"Error loading wallets"}):e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsx(je,{items:ge.threeTier("Finance","/finance","Wallets")}),e.jsx(be,{title:"Wallets",description:"Manage user wallets and balances",actions:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(y,{onClick:E,variant:"outline",className:"border-[#4A36EC] text-[#4A36EC] hover:bg-[#4A36EC] hover:text-white",children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Search"]}),e.jsxs(y,{onClick:i,className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(We,{className:"w-4 h-4 mr-2"}),"Add Wallet"]})]})}),e.jsx(Ne,{cards:A}),e.jsx(fe.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:e.jsx(Ee,{columns:W,data:n,loading:j,placeholder:"Search wallets...",tableStyle:"border rounded-lg bg-white",tableHeadClassName:"text-[#4A36EC] font-semibold"})})]})}export{Ge as default};
