import{A as C,e as n,b as N,r as m,j as e,a as f,U as E,S as F,m as M,d}from"./index-C2Q_LmeJ.js";import{B as P,a as T,P as I}from"./pageHeader-7vhK00zh.js";import{D as U}from"./index-CvxHYYsL.js";import{u as L}from"./modal-helpers-CaXMt30Z.js";import{C as w}from"./card-grid-CZ4tobzV.js";import{u as K,F as $,b as g,c as h,d as x,e as y,f as j}from"./form-CcMvRR1f.js";import{u as _}from"./useMutation-TZLAPFAD.js";import{u as B}from"./useQuery-CUE0UVvY.js";import{s as D,o as q,b as R,a as G}from"./index-DyAPY9a1.js";import{I as Q}from"./input-fvZZM-h7.js";import{M as H}from"./multi-select-GP_yjtwv.js";import{u as O}from"./applications.queries-BK7IP6Ii.js";import{L as V}from"./loader-circle-BgVhgLVT.js";import{M as k,F as z}from"./menu-DQSUJg--.js";import{P as J}from"./plus-BFloapdy.js";import"./table-CAIVgxvw.js";import"./dialog-BxdRvcNA.js";import"./select-K8uUziWX.js";import"./arrow-left-DT7SArHl.js";import"./arrow-right-Ct_-AZHB.js";import"./card-CVylEmF3.js";import"./popover-CI77UgAE.js";import"./globe-C44rbEdp.js";import"./utils-km2FGkQ4.js";import"./badge-rX3Jh1SJ.js";import"./separator-q4J_vRT3.js";import"./circle-x-DWBwq746.js";import"./wand-sparkles-JjYTZCVz.js";const c=C.ACCESS_MANAGEMENT.GROUP;class A{static async getGroup(s){return n.get(`${c.DETAIL(s)}`)}static async createGroup(s){return n.post(c.CREATE,s)}static async updateGroup(s,a){return n.put(`${c}/${s}`,a)}static async deleteGroup(s){return n.delete(`${c}/${s}`)}static async getGroupStats(s){return n.get(`${c}/${s}/stats`)}static async getGroupList(s){return n.get(c.BASE,{params:s})}}const u={all:["group"],list:()=>[...u.all,"list"],details:r=>[...u.all,"details",r],stats:r=>[...u.all,"stats",r]},W=()=>B({queryKey:u.list(),queryFn:()=>A.getGroupList()}),X=()=>{const r=N();return _({mutationFn:s=>A.createGroup(s),onSuccess:()=>{r.invalidateQueries({queryKey:u.all})}})},Y=q({title:G().min(1,"Group name is required"),group_applications:R(G()).min(1,"Select at least one application")});function Z({onSubmit:r,loading:s=!1}){const{data:a}=O(),l=m.useMemo(()=>(a==null?void 0:a.data.map(t=>({label:t.name,value:t.application_id})))||[],[a==null?void 0:a.data]);console.log("applicationsData",l);const i=K({resolver:D(Y),defaultValues:{title:"",group_applications:[]}}),p=t=>{r(t),i.reset()};return e.jsx($,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(p),className:"space-y-6",children:[e.jsx(g,{control:i.control,name:"title",render:({field:t})=>e.jsxs(h,{children:[e.jsx(x,{children:"Group Name"}),e.jsx(y,{children:e.jsx(Q,{...t,placeholder:"Enter group name"})}),e.jsx(j,{})]})}),e.jsx(g,{control:i.control,name:"group_applications",render:({field:t})=>e.jsxs(h,{children:[e.jsx(x,{children:"Applications"}),e.jsx(y,{children:e.jsx(H,{options:l,onValueChange:t.onChange,value:t.value,placeholder:"Select applications"})}),e.jsx(j,{})]})}),e.jsx("div",{className:"flex justify-end space-x-2",children:e.jsx(f,{type:"submit",className:"bg-[#4A36EC] text-white",disabled:s,children:s?e.jsx(V,{className:"w-4 h-4 mr-2 animate-spin"}):"Create Group"})})]})})}function Fe(){const r=L(),{data:s,isLoading:a}=W(),l=m.useMemo(()=>(s==null?void 0:s.data)||[],[s==null?void 0:s.data]),i=m.useMemo(()=>[{header:"Group Name",accessorKey:"name"},{header:"Description",accessorKey:"description",cell:({row:o})=>e.jsx("span",{className:"text-gray-600",children:o.original.description||"No description"})},{header:"Users",accessorKey:"users",cell:({row:o})=>e.jsxs("span",{className:"text-gray-600",children:[o.original.users.length," users"]})},{header:"Permissions",accessorKey:"permissions",cell:({row:o})=>e.jsxs("span",{className:"text-gray-600",children:[o.original.permissions.length," permissions"]})},{header:"Status",accessorKey:"isActive",cell:({row:o})=>e.jsx("span",{className:`px-2 py-1 rounded text-xs ${o.original.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:o.original.isActive?"Active":"Inactive"})}],[]),p=X(),t=async o=>{try{await p.mutateAsync(o),d.success("Group created successfully"),r.close()}catch(S){console.error("Error creating group:",S),d.error("Failed to create group. Please try again.")}},b=()=>{r.openForm({title:"Create New Group",size:"md",showFooter:!1,children:e.jsx(Z,{onSubmit:t})})},v=[{title:"Total Groups",value:l.length,Icon:E,description:"Active groups",trend:"+2.5%",trendUp:!0},{title:"Menu Access",value:0,Icon:k,description:"Assigned menus",trend:"+1.8%",trendUp:!0},{title:"Permissions",value:0,Icon:F,description:"Total permissions",trend:"+3.2%",trendUp:!0},{title:"Menu Groups",value:0,Icon:z,description:"Assigned groups",trend:"+1.5%",trendUp:!0}];return e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsx(P,{items:T.threeTier("Access Control","/access-control","Groups")}),e.jsx(I,{title:"Groups",description:"Manage user groups and their access rights",actions:e.jsxs(f,{onClick:b,className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Add Group"]})}),e.jsx(w,{cards:v}),e.jsx(M.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:e.jsx(U,{data:l,columns:i,loading:a,tableStyle:"border rounded-lg bg-white",tableHeadClassName:"text-[#4A36EC] font-semibold"})})]})}export{Fe as default};
