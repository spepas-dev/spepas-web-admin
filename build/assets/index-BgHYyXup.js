import{r as l,u as X,b as J,j as e,c as W,P as $,d as F,e as Y,f as Z,g as _,h as ee,A as y,i as se,k as te,t as re,a as I,S as ae,U as ne,l as ie,n as L,m as U}from"./index-Cx3yMQ3f.js";import{D as oe}from"./index-D0svd0GM.js";import{C as ce}from"./card-grid-C7Gl_Uh6.js";import{u as le,a as de,F as me,b as k,c as E,d as P,e as S,f as w}from"./form-DABIbnA-.js";import{u as ue}from"./useMutation-DdnS_ohS.js";import{u as pe}from"./useQuery-Ly3xzLnF.js";import{s as he,o as K,a as O,b as D}from"./index-CJEG_s-O.js";import{u as xe,S as fe,a as ge,b as je,c as be,d as ye}from"./select-5_mZnO0V.js";import{D as Ce,a as ve,b as Ne,c as ke,d as Ee}from"./dialog-OWjewGbD.js";import{I as Pe}from"./input-BY_FTDhY.js";import{T as Ae}from"./textarea-CLf_UvS5.js";import{T as Se}from"./trash-2-78zht_3s.js";import{P as q}from"./plus-BarkCOgP.js";import{L as we}from"./lock-avjGx2IR.js";import{F as De}from"./file-check-Dbkuls_G.js";import{f as Ie}from"./format-CBpsKyOP.js";import"./table-CbxoolaY.js";import"./sliders-horizontal-CPYaJ2M2.js";import"./x-45uRG9y6.js";import"./arrow-left-CEUZlc21.js";import"./arrow-right-DHaoxvRn.js";import"./card-BtOxIeoK.js";import"./popover-CAKtuJnK.js";import"./globe-CgBe-rT5.js";var M="Checkbox",[Re,fs]=W(M),[Me,Te]=Re(M),B=l.forwardRef((t,r)=>{const{__scopeCheckbox:a,name:n,checked:i,defaultChecked:o,required:h,disabled:m,value:x="on",onCheckedChange:d,form:s,...c}=t,[u,g]=l.useState(null),j=X(r,p=>g(p)),v=l.useRef(!1),T=u?s||!!u.closest("form"):!0,[b=!1,R]=J({prop:i,defaultProp:o,onChange:d}),V=l.useRef(b);return l.useEffect(()=>{const p=u==null?void 0:u.form;if(p){const N=()=>R(V.current);return p.addEventListener("reset",N),()=>p.removeEventListener("reset",N)}},[u,R]),e.jsxs(Me,{scope:a,state:b,disabled:m,children:[e.jsx($.button,{type:"button",role:"checkbox","aria-checked":f(b)?"mixed":b,"aria-required":h,"data-state":H(b),"data-disabled":m?"":void 0,disabled:m,value:x,...c,ref:j,onKeyDown:F(t.onKeyDown,p=>{p.key==="Enter"&&p.preventDefault()}),onClick:F(t.onClick,p=>{R(N=>f(N)?!0:!N),T&&(v.current=p.isPropagationStopped(),v.current||p.stopPropagation())})}),T&&e.jsx(Fe,{control:u,bubbles:!v.current,name:n,value:x,checked:b,required:h,disabled:m,form:s,style:{transform:"translateX(-100%)"},defaultChecked:f(o)?!1:o})]})});B.displayName=M;var z="CheckboxIndicator",G=l.forwardRef((t,r)=>{const{__scopeCheckbox:a,forceMount:n,...i}=t,o=Te(z,a);return e.jsx(Y,{present:n||f(o.state)||o.state===!0,children:e.jsx($.span,{"data-state":H(o.state),"data-disabled":o.disabled?"":void 0,...i,ref:r,style:{pointerEvents:"none",...t.style}})})});G.displayName=z;var Fe=t=>{const{control:r,checked:a,bubbles:n=!0,defaultChecked:i,...o}=t,h=l.useRef(null),m=xe(a),x=Z(r);l.useEffect(()=>{const s=h.current,c=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(c,"checked").set;if(m!==a&&g){const j=new Event("click",{bubbles:n});s.indeterminate=f(a),g.call(s,f(a)?!1:a),s.dispatchEvent(j)}},[m,a,n]);const d=l.useRef(f(a)?!1:a);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:i??d.current,...o,tabIndex:-1,ref:h,style:{...t.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function f(t){return t==="indeterminate"}function H(t){return f(t)?"indeterminate":t?"checked":"unchecked"}var Le=B,Ue=G;function $e({className:t,...r}){return e.jsx(Le,{"data-slot":"checkbox",className:_("peer border-input data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground data-[state=checked]:border-primary ring-ring/10 dark:ring-ring/20 dark:outline-ring/40 outline-ring/50 size-4 shrink-0 rounded-[4px] border shadow-xs transition-[color,box-shadow] focus-visible:ring-4 focus-visible:outline-1 disabled:cursor-not-allowed disabled:opacity-50 aria-invalid:focus-visible:ring-0",t),...r,children:e.jsx(Ue,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current",children:e.jsx(ee,{className:"size-3.5"})})})}const C=se.ACCESS_MANAGEMENT.PERMISSION;class Q{static async getPermission(r){return y.get(`${C}/${r}`)}static async createPermission(r){return y.post(C.CREATE,r)}static async updatePermission(r,a){return y.put(C.UPDATE,a)}static async deletePermission(r){return y.delete(`${C}/${r}`)}static async getPermissionList(r){return y.get(C.BASE,{params:r})}static async getPermissionStats(r){return y.get(`${C}/${r}/stats`)}}const A={all:["permission"],list:()=>[...A.all,"list"],details:t=>[...A.all,"details",t],stats:t=>[...A.all,"stats",t]},_e=()=>pe({queryKey:A.list(),queryFn:()=>Q.getPermissionList()}),Ke=()=>{const t=te();return ue({mutationFn:r=>Q.createPermission(r),onSuccess:()=>{t.invalidateQueries({queryKey:A.all}),re.success("Permission created successfully")}})},Oe=K({name:D().min(1,"Permission name is required"),description:D().min(10,"Description must be at least 10 characters"),module:D().min(1,"Module is required"),actions:O(D()).min(1,"Select at least one action")}),qe=K({permissions:O(Oe).min(1,"Add at least one permission")}),Be=["create","read","update","delete","approve","reject"],ze=["inventory","sales","purchases","reports","users","settings"];function Ge({open:t,onOpenChange:r,onSubmit:a}){const n=le({resolver:he(qe),defaultValues:{permissions:[{name:"",description:"",module:"",actions:[]}]}}),{fields:i,append:o,remove:h}=de({control:n.control,name:"permissions"}),m=x=>{a(x.permissions),n.reset()};return e.jsx(Ce,{open:t,onOpenChange:r,children:e.jsxs(ve,{className:"max-w-2xl bg-white",children:[e.jsxs(Ne,{children:[e.jsx(ke,{className:"text-[#4A36EC] text-xl font-bold",children:"Add Permissions"}),e.jsx(Ee,{className:"text-gray-600",children:"Define new permissions and their access levels"})]}),e.jsx(me,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(m),className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:i.map((x,d)=>e.jsxs("div",{className:"flex gap-4 items-start",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsx(k,{control:n.control,name:`permissions.${d}.name`,render:({field:s})=>e.jsxs(E,{children:[e.jsx(P,{className:"text-gray-700",children:"Permission Name"}),e.jsx(S,{children:e.jsx(Pe,{placeholder:"Enter permission name",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",...s})}),e.jsx(w,{className:"text-red-500"})]})}),e.jsx(k,{control:n.control,name:`permissions.${d}.description`,render:({field:s})=>e.jsxs(E,{children:[e.jsx(P,{className:"text-gray-700",children:"Description"}),e.jsx(S,{children:e.jsx(Ae,{placeholder:"Enter permission description",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",...s})}),e.jsx(w,{className:"text-red-500"})]})}),e.jsx(k,{control:n.control,name:`permissions.${d}.module`,render:({field:s})=>e.jsxs(E,{children:[e.jsx(P,{className:"text-gray-700",children:"Module"}),e.jsxs(fe,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(S,{children:e.jsx(ge,{className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",children:e.jsx(je,{placeholder:"Select module"})})}),e.jsx(be,{children:ze.map(c=>e.jsx(ye,{value:c,children:c.charAt(0).toUpperCase()+c.slice(1)},c))})]}),e.jsx(w,{className:"text-red-500"})]})}),e.jsx(k,{control:n.control,name:`permissions.${d}.actions`,render:()=>e.jsxs(E,{children:[e.jsx(P,{className:"text-gray-700",children:"Actions"}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:Be.map(s=>e.jsx(k,{control:n.control,name:`permissions.${d}.actions`,render:({field:c})=>{var u;return e.jsxs(E,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(S,{children:e.jsx($e,{checked:(u=c.value)==null?void 0:u.includes(s),onCheckedChange:g=>{var j;return g?c.onChange([...c.value,s]):c.onChange((j=c.value)==null?void 0:j.filter(v=>v!==s))}})}),e.jsx(P,{className:"text-sm font-normal",children:s.charAt(0).toUpperCase()+s.slice(1)})]},s)}},s))}),e.jsx(w,{className:"text-red-500"})]})})]}),i.length>1&&e.jsx(I,{type:"button",variant:"outline",size:"icon",className:"mt-8 hover:bg-gray-100",onClick:()=>h(d),children:e.jsx(Se,{className:"w-4 h-4 text-gray-600"})})]},x.id))}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(I,{type:"button",variant:"outline",className:"hover:bg-gray-100",onClick:()=>o({name:"",description:"",module:"",actions:[]}),children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Add Another"]}),e.jsx(I,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:"Save Permissions"})]})]})})]})})}function gs(){const[t,r]=l.useState(!1),[a,n]=l.useState([]),{data:i,isError:o,isLoading:h}=_e();l.useEffect(()=>(i&&n(i.data),()=>{n([])}),[i==null?void 0:i.data]);const m=l.useMemo(()=>[{header:"Permission Name",accessorKey:"title"},{header:"Description",accessorKey:"description"},{header:"Status",accessorKey:"status",cell:({row:s})=>e.jsx("span",{className:_(s.original.status===1?"text-green-900 bg-green-100":"text-red-900 bg-red-100","text-sm px-2 py-1 rounded-md"),children:s.original.status===1?"Active":"Inactive"})},{header:"Created On",accessorKey:"date_added",cell:({row:s})=>e.jsx("span",{children:Ie(new Date(s.original.date_added),"dd/MM/yyyy")})}],[]);Ke();const x=async s=>{console.log(s),n([...a,...s]),r(!1)},d=[{title:"Total Permissions",value:a.length,Icon:ae,description:"Active permissions in system",trend:"+2.5%",trendUp:!0},{title:"User Groups",value:8,Icon:ne,description:"Groups with permissions",trend:"+1.2%",trendUp:!0},{title:"Access Levels",value:new Set(a.map(s=>s.permissionID)).size,Icon:we,description:"Different access levels",trend:"+3.4%",trendUp:!0},{title:"Modules",value:12,Icon:De,description:"Protected modules",trend:"+1.8%",trendUp:!0}];return h?e.jsx("div",{className:"p-8 space-y-8",children:e.jsx(ie,{})}):o?e.jsx("div",{children:"Error loading permissions"}):e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx("a",{href:"/",className:"hover:text-[#4A36EC]",children:"Dashboard"}),e.jsx(L,{className:"w-4 h-4 mx-2"}),e.jsx("a",{href:"/access-control",className:"hover:text-[#4A36EC]",children:"Access Control"}),e.jsx(L,{className:"w-4 h-4 mx-2"}),e.jsx("span",{className:"text-[#4A36EC] font-medium",children:"Permissions"})]}),e.jsxs(U.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-[#4A36EC]",children:"Permissions"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage system permissions and access controls"})]}),e.jsxs(I,{onClick:()=>r(!0),className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Add Permission"]})]}),e.jsx(ce,{cards:d}),e.jsx(U.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:e.jsx(oe,{data:a,columns:m,loading:h,tableStyle:"border rounded-lg bg-white",tableHeadClassName:"text-[#4A36EC] font-semibold"})}),e.jsx(Ge,{open:t,onOpenChange:r,onSubmit:x})]})}export{gs as default};
