import{e as o,A as U,r as M,j as e,x as y,a as E,c as S,v as _,U as C,m as I,d as A}from"./index-C2Q_LmeJ.js";import{B as D,a as w,P as F}from"./pageHeader-7vhK00zh.js";import{D as P}from"./index-CvxHYYsL.js";import{u as $}from"./modal-helpers-CaXMt30Z.js";import{C as B}from"./card-grid-CZ4tobzV.js";import{u as K,F as T,b as g,c as x,d as j,e as f,f as b}from"./form-CcMvRR1f.js";import{u as G}from"./useQuery-CUE0UVvY.js";import{s as q,z as l}from"./index-DyAPY9a1.js";import{u as z,G as L,M as R}from"./esm-TUw15Obf.js";import{I as N}from"./input-fvZZM-h7.js";import{M as V}from"./multi-select-GP_yjtwv.js";import{M as k}from"./map-pin-D3JmskLF.js";import{P as H}from"./plus-BFloapdy.js";import"./table-CAIVgxvw.js";import"./dialog-BxdRvcNA.js";import"./select-K8uUziWX.js";import"./arrow-left-DT7SArHl.js";import"./arrow-right-Ct_-AZHB.js";import"./card-CVylEmF3.js";import"./popover-CI77UgAE.js";import"./globe-C44rbEdp.js";import"./utils-km2FGkQ4.js";import"./badge-rX3Jh1SJ.js";import"./separator-q4J_vRT3.js";import"./circle-x-DWBwq746.js";import"./wand-sparkles-JjYTZCVz.js";const c=U.USER_MANAGEMENT.MEPA;class J{static async registerMepa(a){return o.post(`${c.BASE}`,a)}static async getMepa(a){return o.get(`${c}/${a}`)}static async updateMepa(a,t){return o.put(`${c}/${a}`,t)}static async deleteMepa(a){return o.delete(`${c}/${a}`)}static async getMepaStats(a){return o.get(`${c}/${a}/stats`)}static async getMepaList(a){return o.get(`${c.BASE}`,{params:a})}}const p={all:["mepas"],list:()=>[...p.all,"list"],details:r=>[...p.all,"details",r],stats:r=>[...p.all,"stats",r]},O=()=>G({queryKey:p.list(),queryFn:()=>J.getMepaList()}),Q=l.object({shop_name:l.string().min(1,"Shop name is required"),address:l.string().min(1,"Address is required"),longitude:l.number(),latitude:l.number(),User_ID:l.string().min(1,"Please select a user")}),W=[{value:"user1",label:"John Doe",icon:y},{value:"user2",label:"Jane Smith",icon:y}],X=["places"];function Y({onSubmit:r,loading:a=!1,selectedLocation:t}){const{isLoaded:u,loadError:m}=z({googleMapsApiKey:"",libraries:X}),d=M.useMemo(()=>({lat:5.6037,lng:-.187}),[]),i=K({resolver:q(Q),defaultValues:{shop_name:"",address:"",longitude:(t==null?void 0:t.lng)||d.lng,latitude:(t==null?void 0:t.lat)||d.lat,User_ID:""}}),h=s=>{const n={shop_name:s.shop_name,address:s.address,location:{type:"Point",coordinates:[s.longitude,s.latitude]},User_ID:s.User_ID};r(n),i.reset()};return m?e.jsx("div",{children:"Error loading map"}):u?e.jsx(T,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(h),className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"flex gap-4 items-start",children:e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsx(g,{control:i.control,name:"User_ID",render:({field:s})=>e.jsxs(x,{children:[e.jsx(j,{className:"text-gray-700",children:"Select User"}),e.jsx(f,{children:e.jsx(V,{options:W,value:[s.value],onValueChange:n=>s.onChange(n[0]),placeholder:"Select a user",maxCount:1,disabled:a})}),e.jsx(b,{className:"text-red-500"})]})}),e.jsx(g,{control:i.control,name:"shop_name",render:({field:s})=>e.jsxs(x,{children:[e.jsx(j,{className:"text-gray-700",children:"Shop Name"}),e.jsx(f,{children:e.jsx(N,{placeholder:"Enter shop name",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",disabled:a,...s})}),e.jsx(b,{className:"text-red-500"})]})}),e.jsx(g,{control:i.control,name:"address",render:({field:s})=>e.jsxs(x,{children:[e.jsx(j,{className:"text-gray-700",children:"Address"}),e.jsx(f,{children:e.jsx(N,{placeholder:"Enter address",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",disabled:a,...s})}),e.jsx(b,{className:"text-red-500"})]})}),e.jsx("div",{className:"h-[200px] rounded-lg overflow-hidden",children:e.jsx(L,{zoom:13,center:d,mapContainerClassName:"w-full h-full",onClick:s=>{s.latLng&&(i.setValue("latitude",s.latLng.lat()),i.setValue("longitude",s.latLng.lng()))},children:e.jsx(R,{position:{lat:i.watch("latitude"),lng:i.watch("longitude")}})})})]})})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(E,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",disabled:a,children:a?"Saving...":"Save Mechanic"})})]})}):e.jsx("div",{children:"Loading..."})}function Ne(){const{data:r,isLoading:a}=O(),t=M.useMemo(()=>(r==null?void 0:r.data)||[],[r==null?void 0:r.data]),u=M.useMemo(()=>[{header:"Shop Name",accessorKey:"shop_name",cell:({row:s})=>e.jsx("div",{children:s.original.shop_name})},{header:"Address",accessorKey:"address",cell:({row:s})=>e.jsx("div",{children:s.original.address})},{header:"User ID",accessorKey:"User_ID",cell:({row:s})=>e.jsx("div",{children:s.original.User_ID})},{header:"Status",accessorKey:"status",cell:({row:s})=>{const n=s.original.status===1;return e.jsxs("span",{className:S("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",n?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:[e.jsx("span",{className:S("w-1.5 h-1.5 rounded-full mr-1.5",n?"bg-green-400":"bg-red-400")}),n?"Active":"Inactive"]})}},{header:"Date Added",accessorKey:"date_added",cell:({row:s})=>e.jsx("div",{children:new Date(s.original.date_added).toLocaleDateString()})}],[]),m=$(),d=()=>{m.openForm({title:"Add New Mechanic Shop",children:e.jsx(Y,{onSubmit:i,loading:!1}),showFooter:!1})},i=async s=>{try{console.log(s),A.success("Mechanic shop created successfully"),m.close()}catch{A.error("Failed to create mechanic shop")}},h=[{title:"Total Mechanics",value:t.length,Icon:y,description:"Registered mechanic shops",trend:"+2.5%",trendUp:!0},{title:"Active Locations",value:t.length,Icon:k,description:"Service locations",trend:"+1.8%",trendUp:!0},{title:"Shop Types",value:12,Icon:_,description:"Different specializations",trend:"+3.2%",trendUp:!0},{title:"Service Areas",value:new Set(t.map(s=>{var n,v;return(v=(n=s.address)==null?void 0:n.split(",").pop())==null?void 0:v.trim()})).size,Icon:C,description:"Areas covered",trend:"+0.9%",trendUp:!0}];return e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsx(D,{items:w.threeTier("User Management","/user-management","Mepas")}),e.jsx(F,{title:"Mepas",description:"Manage mepas and their locations",actions:e.jsxs(E,{onClick:d,className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Add Mechanic Shop"]})}),e.jsx(B,{cards:h}),e.jsx(I.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:e.jsx(P,{data:t,columns:u,loading:a,tableStyle:"border rounded-lg bg-white",tableHeadClassName:"text-[#4A36EC] font-semibold"})})]})}export{Ne as default};
