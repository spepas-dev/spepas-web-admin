import{r as x,j as e,z as w,a as f,E as R,U as V,n as D,m as N}from"./index-CG3cDFil.js";import{C as B,a as J}from"./card-TUnhNMrf.js";import{s as O,o as k,a as H,b,n as T}from"./index-Cksdco4c.js";import{u as I,G as _,M as F,I as q}from"./esm-CrBfFAW1.js";import{u as G,a as K,F as W,b as v,c as C,d as A,e as E,f as S}from"./form-_i_eYalU.js";import{D as Q,a as X,b as Y,c as Z,d as L}from"./dialog-V-TE0CwV.js";import{I as U}from"./input-0St3XTHq.js";import{M as ee}from"./multi-select-CynJAMoS.js";import{T as se}from"./trash-2-X-Fq5KTG.js";import{P}from"./plus-CgI7Ta1y.js";import{T as ae,a as re,b as M,c as y,d as le,e as j}from"./table-CXQMyFfb.js";import{M as z}from"./map-pin-DdQqKxnr.js";import"./x-BgpYH4Yb.js";import"./badge-CWZmtTXQ.js";import"./popover-P3KGh40z.js";import"./wand-sparkles-C-ss3xfk.js";const te=k({shop_name:b().min(1,"Shop name is required"),longitude:T(),latitude:T(),address:b().min(1,"Address is required"),User_ID:b().min(1,"Please select a user")}),ne=k({mechanics:H(te).min(1,"Add at least one mechanic shop")}),ie=[{value:"user1",label:"John Doe",icon:w},{value:"user2",label:"Jane Smith",icon:w}],oe=["places"];function ce({open:i,onOpenChange:o,onSubmit:a,selectedLocation:s}){const{isLoaded:m,loadError:c}=I({googleMapsApiKey:"",libraries:oe}),l=x.useMemo(()=>({lat:5.6037,lng:-.187}),[]),r=G({resolver:O(ne),defaultValues:{mechanics:[{shop_name:"",longitude:(s==null?void 0:s.lng)||l.lng,latitude:(s==null?void 0:s.lat)||l.lat,address:"",User_ID:""}]}}),{fields:n,append:u,remove:t}=K({control:r.control,name:"mechanics"});x.useEffect(()=>{i||r.reset({mechanics:[{shop_name:"",longitude:(s==null?void 0:s.lng)||l.lng,latitude:(s==null?void 0:s.lat)||l.lat,address:"",User_ID:""}]})},[i,s,l]);const h=g=>{a(g.mechanics),r.reset()};return c?e.jsx("div",{children:"Error loading map. Please check your API key."}):m?e.jsx(Q,{open:i,onOpenChange:o,children:e.jsxs(X,{className:"max-w-2xl bg-white",children:[e.jsxs(Y,{children:[e.jsx(Z,{className:"text-[#4A36EC] text-xl font-bold",children:"Add Mechanic Shop"}),e.jsx(L,{className:"text-gray-600",children:"Register new mechanic shops and their locations"})]}),e.jsx(W,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(h),className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:n.map((g,p)=>e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg",children:[e.jsx(v,{control:r.control,name:`mechanics.${p}.User_ID`,render:({field:d})=>e.jsxs(C,{children:[e.jsx(A,{className:"text-gray-700",children:"Select Mechanic"}),e.jsx(E,{children:e.jsx(ee,{options:ie,value:[d.value],onValueChange:$=>d.onChange($[0]),placeholder:"Select a mechanic",maxCount:1,variant:"default"})}),e.jsx(S,{className:"text-red-500"})]})}),e.jsx(v,{control:r.control,name:`mechanics.${p}.shop_name`,render:({field:d})=>e.jsxs(C,{children:[e.jsx(A,{className:"text-gray-700",children:"Shop Name"}),e.jsx(E,{children:e.jsx(U,{placeholder:"Enter shop name",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",...d})}),e.jsx(S,{className:"text-red-500"})]})}),e.jsx(v,{control:r.control,name:`mechanics.${p}.address`,render:({field:d})=>e.jsxs(C,{children:[e.jsx(A,{className:"text-gray-700",children:"Address"}),e.jsx(E,{children:e.jsx(U,{placeholder:"Enter shop address",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",...d})}),e.jsx(S,{className:"text-red-500"})]})}),e.jsx("div",{className:"h-[200px] rounded-lg overflow-hidden",children:e.jsx(_,{zoom:13,center:l,mapContainerClassName:"w-full h-full",onClick:d=>{d.latLng&&(r.setValue(`mechanics.${p}.latitude`,d.latLng.lat()),r.setValue(`mechanics.${p}.longitude`,d.latLng.lng()))},children:e.jsx(F,{position:{lat:g.latitude,lng:g.longitude}})})}),n.length>1&&e.jsx(f,{type:"button",variant:"outline",size:"icon",className:"hover:bg-gray-100",onClick:()=>t(p),children:e.jsx(se,{className:"w-4 h-4 text-gray-600"})})]},g.id))}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(f,{type:"button",variant:"outline",className:"hover:bg-gray-100",onClick:()=>u({shop_name:"",longitude:l.lng,latitude:l.lat,address:"",User_ID:""}),children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Add Another"]}),e.jsx(f,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:"Save Shops"})]})]})})]})}):e.jsx("div",{children:"Loading..."})}const de=["places"];function me({mechanics:i,selectedLocation:o,onLocationSelect:a}){const{isLoaded:s,loadError:m}=I({googleMapsApiKey:"",libraries:de}),[c,l]=x.useState(null),r=x.useMemo(()=>o||{lat:5.6037,lng:-.187},[o]);return m?e.jsx("div",{className:"h-full flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"text-red-600",children:"Error loading map. Please check your API key."})}):s?e.jsxs(_,{zoom:13,center:r,mapContainerClassName:"w-full h-full",onClick:n=>{n.latLng&&a({lat:n.latLng.lat(),lng:n.latLng.lng()})},children:[i.map((n,u)=>e.jsx(F,{position:{lat:n.latitude,lng:n.longitude},onClick:()=>l(n)},u)),c&&e.jsx(q,{position:{lat:c.latitude,lng:c.longitude},onCloseClick:()=>l(null),children:e.jsxs("div",{className:"p-2",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:c.shop_name}),e.jsx("p",{className:"text-sm text-gray-600",children:c.address})]})})]}):e.jsx("div",{className:"h-full flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"text-gray-600",children:"Loading map..."})})}const he={user1:{name:"John Doe",email:"john@example.com"},user2:{name:"Jane Smith",email:"jane@example.com"}};function xe({mechanics:i,onLocationSelect:o}){return e.jsx("div",{className:"border rounded-lg bg-white",children:e.jsxs(ae,{children:[e.jsx(re,{children:e.jsxs(M,{className:"bg-gray-50",children:[e.jsx(y,{className:"text-[#4A36EC] font-semibold",children:"Shop Name"}),e.jsx(y,{className:"text-[#4A36EC] font-semibold",children:"Owner"}),e.jsx(y,{className:"text-[#4A36EC] font-semibold",children:"Address"}),e.jsx(y,{className:"text-[#4A36EC] font-semibold",children:"Location"})]})}),e.jsxs(le,{children:[i.map((a,s)=>{var m;return e.jsxs(M,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(j,{className:"text-gray-700 font-medium",children:a.shop_name}),e.jsx(j,{className:"text-gray-700",children:((m=he[a.User_ID])==null?void 0:m.name)||"Unknown User"}),e.jsx(j,{className:"text-gray-700",children:a.address}),e.jsx(j,{children:e.jsxs(f,{variant:"outline",size:"sm",className:"hover:bg-[#4A36EC]/10",onClick:()=>o({lat:a.latitude,lng:a.longitude}),children:[e.jsx(z,{className:"w-4 h-4 mr-2 text-[#4A36EC]"}),"View on Map"]})})]},s)}),i.length===0&&e.jsx(M,{children:e.jsx(j,{colSpan:4,className:"text-center text-gray-500 py-8",children:"No mechanic shops added yet"})})]})]})})}function Te(){const[i,o]=x.useState(!1),[a,s]=x.useState([]),[m,c]=x.useState(null),[l,r]=x.useState(null),n=async t=>{try{console.log(t),s([...a,...t]),o(!1),r(null)}catch(h){r("Failed to add mechanics"),console.error(h)}},u=[{title:"Total Mechanics",value:a.length,icon:R,description:"Registered mechanic shops",trend:"+2.5%",trendUp:!0},{title:"Active Locations",value:a.length,icon:z,description:"Service locations",trend:"+1.8%",trendUp:!0},{title:"Shop Types",value:"12",icon:w,description:"Different specializations",trend:"+3.2%",trendUp:!0},{title:"Service Areas",value:new Set(a.map(t=>{var h;return(h=t.address.split(",").pop())==null?void 0:h.trim()})).size,icon:V,description:"Areas covered",trend:"+0.9%",trendUp:!0}];return e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx("a",{href:"/",className:"hover:text-[#4A36EC]",children:"Dashboard"}),e.jsx(D,{className:"w-4 h-4 mx-2"}),e.jsx("a",{href:"/user-management",className:"hover:text-[#4A36EC]",children:"User Management"}),e.jsx(D,{className:"w-4 h-4 mx-2"}),e.jsx("span",{className:"text-[#4A36EC] font-medium",children:"Mechanics"})]}),e.jsxs(N.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-[#4A36EC]",children:"Mechanic Shops"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage mechanic shops and their locations"})]}),e.jsxs(f,{onClick:()=>o(!0),className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Add Mechanic Shop"]})]}),e.jsx(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:u.map((t,h)=>e.jsx(B,{className:"border border-gray-200 hover:border-[#4A36EC] transition-colors",children:e.jsxs(J,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:t.title}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mt-2",children:t.value})]}),e.jsx("div",{className:"bg-[#4A36EC]/10 p-2 rounded-lg",children:e.jsx(t.icon,{className:"w-5 h-5 text-[#4A36EC]"})})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx("p",{className:"text-xs text-gray-500",children:t.description}),e.jsx("span",{className:`text-xs font-medium ${t.trendUp?"text-green-600":"text-red-600"}`,children:t.trend})]})]})},h))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-6 gap-6",children:[e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"lg:col-span-2 h-[400px] rounded-lg overflow-hidden border",children:e.jsx(me,{mechanics:a,selectedLocation:m,onLocationSelect:c})}),e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"lg:col-span-4",children:e.jsx(xe,{mechanics:a,onLocationSelect:c})})]}),l&&e.jsx("div",{className:"text-red-600 text-sm",children:l}),e.jsx(ce,{open:i,onOpenChange:o,onSubmit:n,selectedLocation:m})]})}export{Te as default};
