import{c as E,z as d,y as C,E as I,f as M,r as g,g as U,j as e,F as D,i as b,k as f,l as j,n as v,o as N,I as w,e as S,p as y,B as F,U as _,s as L,v as P,w as $,C as k,m as K,D as T,t as R}from"./index-BEfPUQd3.js";import{u as B}from"./modal-helpers-u5ghZSiS.js";import{u as q}from"./useMutation-CxnX3va-.js";import{s as z}from"./zod-DPUoip6C.js";import{u as G,G as V,M as Q,a as H}from"./esm-Dq51DQsy.js";import{z as c}from"./index-3Gi9B8Cu.js";import{M as O}from"./multi-select-DEp3z63F.js";import{u as W}from"./users.queries-BzwIn2G9.js";import{P as Z}from"./plus-D6nxsE-o.js";import"./dialog-DfEuW_jS.js";import"./separator-DpEqoi9c.js";import"./circle-x-Bb9PP882.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M16 10h2",key:"8sgtl7"}],["path",{d:"M16 14h2",key:"epxaof"}],["path",{d:"M6.17 15a3 3 0 0 1 5.66 0",key:"n6f512"}],["circle",{cx:"9",cy:"11",r:"2",key:"yxgjnd"}],["rect",{x:"2",y:"5",width:"20",height:"14",rx:"2",key:"qneu4z"}]],X=E("IdCard",J),o=C.USER_MANAGEMENT.RIDER;class A{static async registerRider(s){return d.post(`${o.CREATE}`,s)}static async getRider(s){return d.get(`${o.DETAIL}/${s}`)}static async updateRider(s,i){return d.put(`${o}/${s}`,i)}static async deleteRider(s){return d.delete(`${o}/${s}`)}static async getRiderStats(s){return d.get(`${o}/${s}/stats`)}static async getRiderList(s){return d.get(`${o.BASE}`,{params:s})}}const Y={all:["riders"]},ee=()=>I({queryKey:["rider-list"],queryFn:()=>A.getRiderList()}),re=()=>{const a=M();return q({mutationFn:s=>A.registerRider(s),onSuccess:()=>{a.invalidateQueries({queryKey:Y.all})}})},se=c.object({licenseNumber:c.string().min(1,"License number is required"),longitude:c.number(),latitude:c.number(),User_ID:c.string().min(1,"Please select a user")}),te=["places"];function ae({onSubmit:a,loading:s=!1,selectedLocation:i}){const{isLoaded:x,loadError:u}=G({googleMapsApiKey:"AIzaSyDLsZ984L00maH7hl__gWQ-v7U-KWOEnfU",libraries:te}),{data:l}=W(),h=g.useMemo(()=>{var r;return((r=l==null?void 0:l.data)==null?void 0:r.map(t=>({value:t.User_ID,label:t.name})))||[]},[l]),m=g.useMemo(()=>({lat:5.6037,lng:-.187}),[]),n=U({resolver:z(se),defaultValues:{licenseNumber:"",longitude:(i==null?void 0:i.lng)||m.lng,latitude:(i==null?void 0:i.lat)||m.lat,User_ID:""}}),p=r=>{try{const t={licenseNumber:r.licenseNumber,User_ID:r.User_ID,longitude:r.longitude,latitude:r.latitude};a(t)}catch(t){console.error(t)}finally{n.reset()}};return u?e.jsx("div",{children:"Error loading map"}):x?e.jsx(D,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(p),className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"flex gap-4 items-start",children:e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsx(b,{control:n.control,name:"User_ID",render:({field:r})=>e.jsxs(f,{children:[e.jsx(j,{className:"text-gray-700",children:"Select User"}),e.jsx(v,{children:e.jsx(O,{options:h,value:[r.value],onValueChange:t=>r.onChange(t[0]),placeholder:"Select a user",maxCount:1,disabled:s})}),e.jsx(N,{className:"text-red-500"})]})}),e.jsx(b,{control:n.control,name:"licenseNumber",render:({field:r})=>e.jsxs(f,{children:[e.jsx(j,{className:"text-gray-700",children:"License Number"}),e.jsx(v,{children:e.jsx(w,{placeholder:"Enter license number",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",disabled:s,...r})}),e.jsx(N,{className:"text-red-500"})]})}),e.jsx("div",{className:"h-[200px] rounded-lg overflow-hidden",children:e.jsx(V,{zoom:13,center:m,mapContainerClassName:"w-full h-full",onClick:r=>{r.latLng&&(n.setValue("latitude",r.latLng.lat()),n.setValue("longitude",r.latLng.lng()))},children:e.jsx(Q,{position:{lat:n.watch("latitude"),lng:n.watch("longitude")}})})})]})})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(S,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",disabled:s,children:s?"Saving...":"Save Rider"})})]})}):e.jsx("div",{children:"Loading..."})}function ye(){const{data:a,isLoading:s}=ee();console.log(a);const i=g.useMemo(()=>(a==null?void 0:a.data)||[],[a==null?void 0:a.data]),x=g.useMemo(()=>[{header:"Name",accessorKey:"name",cell:({row:r})=>e.jsx("div",{children:r.original.name})},{header:"Phone Number",accessorKey:"phoneNumber",cell:({row:r})=>e.jsx("div",{children:r.original.phoneNumber})},{header:"Status",accessorKey:"status",cell:({row:r})=>{const t=r.original.status===1;return e.jsxs("span",{className:y("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",t?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:[e.jsx("span",{className:y("w-1.5 h-1.5 rounded-full mr-1.5",t?"bg-green-400":"bg-red-400")}),t?"Active":"Inactive"]})}},{header:"Verification Status",accessorKey:"verificationStatus",cell:({row:r})=>e.jsx("span",{className:y("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",r.original.verificationStatus===1?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:r.original.verificationStatus===1?"Verified":"Unverified"})},{header:"Date Added",accessorKey:"createdAt",cell:({row:r})=>e.jsx("div",{children:new Date(r.original.createdAt).toLocaleDateString()})}],[]),u=B(),l=()=>{u.openForm({title:"Add New Rider",children:e.jsx(ae,{onSubmit:n,loading:!1}),showFooter:!1})},{mutateAsync:h,isPending:m}=re(),n=async r=>{try{const t=await h(r);R.success(`${t.data.name} created successfully `),u.close()}catch{R.error("Failed to create rider")}},p=[{title:"Total Riders",value:i.length,Icon:F,description:"Registered riders",trend:"+2.8%",trendUp:!0},{title:"Active Locations",value:i.length,Icon:H,description:"Service areas",trend:"+1.9%",trendUp:!0},{title:"License Types",value:0,Icon:X,description:"Different categories",trend:"+3.1%",trendUp:!0},{title:"Service Areas",value:"8",Icon:_,description:"Coverage zones",trend:"+2.4%",trendUp:!0}];return e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsx(L,{items:P.threeTier("User Management","/user-management","Riders")}),e.jsx($,{title:"Delivery Riders",description:"Manage delivery riders and their locations",actions:e.jsxs(S,{onClick:l,className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Add Rider"]})}),e.jsx(k,{cards:p}),e.jsx(K.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:e.jsx(T,{data:i,columns:x,loading:s,tableStyle:"border rounded-lg bg-white",tableHeadClassName:"text-[#4A36EC] font-semibold"})})]})}export{ye as default};
