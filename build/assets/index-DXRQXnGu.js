import{A as p,i as se,j as e,a as u,r as h,x as M,h as ae,g as B,W as v,ag as te,ah as le,ai as re,aj as ne,ak as I,al as ce,n as U,m as V,t as ie}from"./index-Cx3yMQ3f.js";import{D as oe}from"./index-D0svd0GM.js";import{C as de}from"./card-grid-C7Gl_Uh6.js";import{u as F,F as L,b as W,c as A,d as me,e as E,f as T}from"./form-DABIbnA-.js";import{u as he}from"./useQuery-Ly3xzLnF.js";import{s as R,z as f}from"./index-CJEG_s-O.js";import{D as P,a as $,b as O,c as k,d as K,e as H}from"./dialog-OWjewGbD.js";import{S as q,a as G,b as J,c as X,d as N}from"./select-5_mZnO0V.js";import{B as w}from"./badge-BQaAw9nc.js";import{P as ue,a as xe,b as pe,C as je,c as ge,e as ye,f as fe,g as Ne}from"./popover-CAKtuJnK.js";import{I as be}from"./input-BY_FTDhY.js";import{C as we}from"./chevrons-up-down-2SnV2VMH.js";import{C as _}from"./credit-card-D0URhJEL.js";import{f as Y}from"./format-CBpsKyOP.js";import{E as Ee}from"./ellipsis-DW0AolC5.js";import{P as Ce}from"./plus-BarkCOgP.js";import"./table-CbxoolaY.js";import"./sliders-horizontal-CPYaJ2M2.js";import"./x-45uRG9y6.js";import"./arrow-left-CEUZlc21.js";import"./arrow-right-DHaoxvRn.js";import"./card-BtOxIeoK.js";import"./globe-CgBe-rT5.js";const j=se.WALLET_MANAGEMENT;class ve{static async getWallets(a){return p.get(j.BASE,{params:a})}static async getWalletByWalletID(a){return p.get(`${j.DETAIL_BY_ID(a)}`)}static async getWalletByWalletNumber(a){return p.get(`${j.DETAIL_BY_WALLET_NUMBER(a)}`)}static async getWalletByUser(a){return p.get(`${j.DETAIL_BY_USER(a)}`)}static async createWallet(a){return p.post(j.CREATE,a)}static async updateWallet(a,x){return p.put(`${j}/${a}`,x)}static async deleteWallet(a){return p.delete(`${j}/${a}`)}}const C={all:["wallets"],detail:c=>[...C.all,"detail",c],lists:()=>[...C.all,"list"],list:c=>[...C.lists(),c]},Se=c=>he({queryKey:C.list({}),queryFn:()=>ve.getWallets(c)}),De=f.object({wallet_type:f.string({required_error:"Please select a wallet type"})});function Ie({open:c,onOpenChange:a,onSubmit:x}){const r=F({resolver:R(De),defaultValues:{wallet_type:""}}),n=l=>{x(l),r.reset()};return e.jsx(P,{open:c,onOpenChange:a,children:e.jsxs($,{className:"sm:max-w-[425px]",children:[e.jsxs(O,{children:[e.jsx(k,{children:"Create New Wallet"}),e.jsx(K,{children:"Create a new wallet for tracking revenue or expenses."})]}),e.jsx(L,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(n),className:"space-y-6",children:[e.jsx(W,{control:r.control,name:"wallet_type",render:({field:l})=>e.jsxs(A,{children:[e.jsx(me,{children:"Wallet Type"}),e.jsxs(q,{onValueChange:l.onChange,defaultValue:l.value,children:[e.jsx(E,{children:e.jsx(G,{children:e.jsx(J,{placeholder:"Select wallet type"})})}),e.jsxs(X,{children:[e.jsx(N,{value:"REVENUE",children:"Revenue"}),e.jsx(N,{value:"EXPENSE",children:"Expense"})]})]}),e.jsx(T,{})]})}),e.jsxs(H,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsx(u,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:"Create Wallet"})]})]})})]})})}const We=[{id:"user123",name:"John Doe"},{id:"user456",name:"Jane Smith"},{id:"user789",name:"Robert Johnson"},{id:"user101",name:"Emily Davis"},{id:"user102",name:"Michael Wilson"}],Ae=f.object({searchType:f.enum(["walletNumber","walletId","userId"]),searchValue:f.string().min(1,"Search value is required")});function Te({open:c,onOpenChange:a,wallets:x}){const[r,n]=h.useState([]),[l,i]=h.useState(null),[b,S]=h.useState(!1),[d,D]=h.useState(null),o=F({resolver:R(Ae),defaultValues:{searchType:"walletNumber",searchValue:""}}),t=o.watch("searchType"),g=s=>{let m=[...x];s.searchType==="walletNumber"?m=m.filter(y=>y.WalletNumber.toLowerCase().includes(s.searchValue.toLowerCase())):s.searchType==="walletId"?m=m.filter(y=>y.walletID.toLowerCase().includes(s.searchValue.toLowerCase())):s.searchType==="userId"&&d&&(m=m.filter(y=>y.User_ID===d.id)),n(m),m.length===1?i(m[0]):i(null)},z=s=>Y(new Date(s),"MMM dd, yyyy"),Q=s=>{switch(s){case 1:return e.jsx(w,{className:"bg-green-500",children:"Active"});case 0:return e.jsx(w,{className:"bg-red-500",children:"Inactive"});default:return e.jsx(w,{className:"bg-gray-500",children:"Unknown"})}},Z=s=>{switch(s){case"REVENUE":return e.jsx(v,{className:"h-4 w-4 text-[#4A36EC]"});case"EXPENSE":return e.jsx(_,{className:"h-4 w-4 text-[#4A36EC]"});default:return e.jsx(v,{className:"h-4 w-4 text-[#4A36EC]"})}},ee=()=>t==="userId"?e.jsxs(ue,{open:b,onOpenChange:S,children:[e.jsx(xe,{asChild:!0,children:e.jsx(E,{children:e.jsxs(u,{variant:"outline",role:"combobox","aria-expanded":b,className:"w-full justify-between",children:[d?d.name:"Select user...",e.jsx(we,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),e.jsx(pe,{className:"w-full p-0",children:e.jsxs(je,{children:[e.jsx(ge,{placeholder:"Search users..."}),e.jsx(ye,{children:"No user found."}),e.jsx(fe,{children:We.map(s=>e.jsxs(Ne,{value:s.name,onSelect:()=>{D(s),S(!1),o.setValue("searchValue",s.id)},children:[e.jsx(ae,{className:B("mr-2 h-4 w-4",(d==null?void 0:d.id)===s.id?"opacity-100":"opacity-0")}),s.name]},s.id))})]})})]}):e.jsx(E,{children:e.jsx(be,{placeholder:t==="walletNumber"?"Enter wallet number (e.g., S000005)":"Enter wallet ID",...o.register("searchValue")})});return e.jsx(P,{open:c,onOpenChange:a,children:e.jsxs($,{className:"sm:max-w-[600px]",children:[e.jsxs(O,{children:[e.jsx(k,{children:"Search Wallets"}),e.jsx(K,{children:"Search for wallets by wallet number, wallet ID, or user."})]}),e.jsx(L,{...o,children:e.jsx("form",{onSubmit:o.handleSubmit(g),className:"space-y-4",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(W,{control:o.control,name:"searchType",render:()=>e.jsxs(A,{className:"w-[180px]",children:[e.jsxs(q,{onValueChange:s=>o.setValue("searchType",s),defaultValue:o.getValues("searchType"),children:[e.jsx(E,{children:e.jsx(G,{children:e.jsx(J,{placeholder:"Search by..."})})}),e.jsxs(X,{children:[e.jsx(N,{value:"walletNumber",children:"Wallet Number"}),e.jsx(N,{value:"walletId",children:"Wallet ID"}),e.jsx(N,{value:"userId",children:"User"})]})]}),e.jsx(T,{})]})}),e.jsx(W,{control:o.control,name:"searchValue",render:()=>e.jsxs(A,{className:"flex-1",children:[ee(),e.jsx(T,{})]})}),e.jsxs(u,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Search"]})]})})}),r.length>0&&e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Found ",r.length," wallet",r.length!==1?"s":""]}),r.map(s=>e.jsxs("div",{className:`p-4 border rounded-lg transition-colors ${(l==null?void 0:l.id)===s.id?"border-[#4A36EC] bg-[#4A36EC]/5":"border-gray-200 hover:border-[#4A36EC]"}`,onClick:()=>i(s),children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[Z(s.wallet_type),e.jsx("h3",{className:"font-medium",children:s.WalletNumber}),e.jsx(w,{variant:"outline",className:"ml-2",children:s.wallet_type})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["ID: ",s.walletID]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-semibold",children:["$",s.balance.toFixed(2)]}),Q(s.status)]})]}),(l==null?void 0:l.id)===s.id&&e.jsxs("div",{className:"mt-4 pt-4 border-t grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"User ID"}),e.jsx("p",{className:"text-base",children:s.User_ID||"Not assigned"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Created"}),e.jsx("p",{className:"text-base",children:z(s.date_created)})]})]})]},s.id))]}),r.length===0&&o.getValues("searchValue")&&e.jsx("div",{className:"text-center py-6",children:e.jsx("p",{className:"text-gray-500",children:"No wallets found matching your search criteria."})}),e.jsx(H,{children:e.jsx(u,{variant:"outline",onClick:()=>a(!1),children:"Close"})})]})})}function ss(){const[c,a]=h.useState(!1),[x,r]=h.useState(!1),[n,l]=h.useState([]),{data:i,isLoading:b,isError:S}=Se();h.useEffect(()=>{i!=null&&i.data&&l(i==null?void 0:i.data),console.log(i)},[i]);const d=h.useMemo(()=>[{header:"Wallet Number",accessorKey:"WalletNumber"},{header:"Wallet Type",accessorKey:"wallet_type"},{header:"Balance",accessorKey:"balance",cell:({row:t})=>e.jsx("span",{children:new Intl.NumberFormat("en-US",{style:"currency",currency:"GHS"}).format(t.original.balance)})},{header:"User ID",accessorKey:"User_ID"},{header:"Status",accessorKey:"status",cell:({row:t})=>e.jsx("span",{className:B("px-2 py-1 rounded-md text-sm",t.original.status===1?"text-green-900 bg-green-200":"text-red-900 bg-red-200"),children:t.original.status===1?"Active":"Inactive"})},{header:"Created On",accessorKey:"date_created",cell:({row:t})=>e.jsx("span",{children:Y(new Date(t.original.date_created),"yyyy/MM/dd HH:mm:a")})},{header:"Actions",id:"actions",accessorKey:"actions",cell:({row:t})=>e.jsx("div",{className:"flex justify-end",children:e.jsxs(te,{children:[e.jsx(le,{asChild:!0,children:e.jsxs(u,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(Ee,{className:"h-4 w-4"})]})}),e.jsxs(re,{align:"end",children:[e.jsx(ne,{children:"Actions"}),e.jsx(I,{children:"View Details"}),e.jsx(I,{children:"Edit Wallet"}),e.jsx(ce,{}),e.jsx(I,{className:"text-red-600",children:"Deactivate"})]})]})})}],[]),D=async t=>{const g={id:n.length+1,walletID:crypto.randomUUID(),date_created:new Date().toISOString(),status:1,wallet_type:t.wallet_type,User_ID:null,WalletNumber:`S${String(n.length+1).padStart(6,"0")}`,balance:0};l([...n,g]),a(!1),ie.success("Wallet created successfully")},o=[{title:"Total Wallets",value:n.length,Icon:v,description:"Active wallets in system",trend:"+3.2%",trendUp:!0},{title:"Total Balance",value:`$${n.reduce((t,g)=>t+g.balance,0).toFixed(2)}`,Icon:_,description:"Combined wallet balance",trend:"+5.4%",trendUp:!0},{title:"Revenue Wallets",value:n.filter(t=>t.wallet_type==="REVENUE").length,Icon:v,description:"Wallets for revenue",trend:"+2.1%",trendUp:!0},{title:"Expense Wallets",value:n.filter(t=>t.wallet_type==="EXPENSE").length,Icon:_,description:"Wallets for expenses",trend:"+1.8%",trendUp:!0}];return e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx("a",{href:"/",className:"hover:text-[#4A36EC]",children:"Dashboard"}),e.jsx(U,{className:"w-4 h-4 mx-2"}),e.jsx("a",{href:"/finance",className:"hover:text-[#4A36EC]",children:"Finance"}),e.jsx(U,{className:"w-4 h-4 mx-2"}),e.jsx("span",{className:"text-[#4A36EC] font-medium",children:"Wallets"})]}),e.jsxs(V.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-[#4A36EC]",children:"Wallets"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage user wallets and balances"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(u,{onClick:()=>r(!0),className:"bg-white hover:bg-gray-100 text-[#4A36EC] border border-[#4A36EC]",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Search"]}),e.jsxs(u,{onClick:()=>a(!0),className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Add Wallet"]})]})]}),e.jsx(de,{cards:o}),e.jsx(V.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:e.jsx(oe,{columns:d,data:n,loading:b,placeholder:"Search wallets...",tableStyle:"border rounded-lg bg-white",tableHeadClassName:"text-[#4A36EC] font-semibold"})}),e.jsx(Ie,{open:c,onOpenChange:a,onSubmit:D}),e.jsx(Te,{open:x,onOpenChange:r,wallets:n})]})}export{ss as default};
